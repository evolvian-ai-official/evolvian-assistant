import{f as m,j as r,R as p,r as o,W as C,C as _}from"./ChatWidget-JLonNhsD.js";function w(){const[e,u]=o.useState(null),[c,a]=o.useState(null),[t,h]=o.useState(null),[l,g]=o.useState({});return o.useEffect(()=>{const i=new URLSearchParams(window.location.search).get("public_client_id");i&&u(i)},[]),o.useEffect(()=>{if(!e)return;(async()=>{const i=window.location.hostname==="localhost"?"http://localhost:8001":"https://evolvian-assistant.onrender.com";try{const n=await fetch(`${i}/client_settings?public_client_id=${e}`);if(!n.ok)return;const s=await n.json(),f=Array.isArray(s)?s[0]:s;g(f||{})}catch(n){console.error("âš ï¸ Error cargando client_settings:",n)}})()},[e]),o.useEffect(()=>{if(!e)return;(async()=>{const i=window.location.hostname==="localhost"?"http://localhost:8001":"https://evolvian-assistant.onrender.com";try{const s=await(await fetch(`${i}/check_consent?public_client_id=${e}`)).json();console.log("ğŸ§¾ Resultado de /check_consent:",s),h(s),a(!!s.valid)}catch(n){console.error("âŒ Error verificando consentimiento:",n),a(!1)}})()},[e]),!e||c===null?r.jsx("div",{style:{color:"#999",textAlign:"center",padding:"2rem"},children:"Loading..."}):c?(console.log("âœ… Consentimiento vÃ¡lido â€” Renderizando ChatWidget"),r.jsx(_,{clientId:e})):(console.log("ğŸªª Mostrando WidgetConsentScreen (usuario sin consentimiento)"),r.jsx(C,{publicClientId:e,clientSettings:l,requireEmailConsent:!!(t!=null&&t.require_email),requirePhoneConsent:!!(t!=null&&t.require_phone),requireTermsConsent:!!(t!=null&&t.require_terms),showLegalLinks:!!l.show_legal_links}))}m.createRoot(document.getElementById("root")).render(r.jsx(p.StrictMode,{children:r.jsx(w,{})}));
