const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-BrKw3Rt1.js","assets/ChatWidget-Cpya50tL.js"])))=>i.map(i=>d[i]);
import{r as g,a as Eo,g as ti,b as ko,R as j,u as W,j as d,C as wr,c as Co,L as Ro}from"./ChatWidget-Cpya50tL.js";var jt={},qn;function To(){if(qn)return jt;qn=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.parse=o,jt.serialize=c;const r=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,i=(()=>{const f=function(){};return f.prototype=Object.create(null),f})();function o(f,y){const p=new i,b=f.length;if(b<2)return p;const m=(y==null?void 0:y.decode)||u;let v=0;do{const x=f.indexOf("=",v);if(x===-1)break;const w=f.indexOf(";",v),S=w===-1?b:w;if(x>S){v=f.lastIndexOf(";",x-1)+1;continue}const E=a(f,v,x),P=l(f,x,E),O=f.slice(E,P);if(p[O]===void 0){let L=a(f,x+1,S),D=l(f,S,L);const H=m(f.slice(L,D));p[O]=H}v=S+1}while(v<b);return p}function a(f,y,p){do{const b=f.charCodeAt(y);if(b!==32&&b!==9)return y}while(++y<p);return p}function l(f,y,p){for(;y>p;){const b=f.charCodeAt(--y);if(b!==32&&b!==9)return y+1}return p}function c(f,y,p){const b=(p==null?void 0:p.encode)||encodeURIComponent;if(!r.test(f))throw new TypeError(`argument name is invalid: ${f}`);const m=b(y);if(!e.test(m))throw new TypeError(`argument val is invalid: ${y}`);let v=f+"="+m;if(!p)return v;if(p.maxAge!==void 0){if(!Number.isInteger(p.maxAge))throw new TypeError(`option maxAge is invalid: ${p.maxAge}`);v+="; Max-Age="+p.maxAge}if(p.domain){if(!t.test(p.domain))throw new TypeError(`option domain is invalid: ${p.domain}`);v+="; Domain="+p.domain}if(p.path){if(!n.test(p.path))throw new TypeError(`option path is invalid: ${p.path}`);v+="; Path="+p.path}if(p.expires){if(!h(p.expires)||!Number.isFinite(p.expires.valueOf()))throw new TypeError(`option expires is invalid: ${p.expires}`);v+="; Expires="+p.expires.toUTCString()}if(p.httpOnly&&(v+="; HttpOnly"),p.secure&&(v+="; Secure"),p.partitioned&&(v+="; Partitioned"),p.priority)switch(typeof p.priority=="string"?p.priority.toLowerCase():void 0){case"low":v+="; Priority=Low";break;case"medium":v+="; Priority=Medium";break;case"high":v+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${p.priority}`)}if(p.sameSite)switch(typeof p.sameSite=="string"?p.sameSite.toLowerCase():p.sameSite){case!0:case"strict":v+="; SameSite=Strict";break;case"lax":v+="; SameSite=Lax";break;case"none":v+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${p.sameSite}`)}return v}function u(f){if(f.indexOf("%")===-1)return f;try{return decodeURIComponent(f)}catch{return f}}function h(f){return s.call(f)==="[object Date]"}return jt}To();/**
 * react-router v7.5.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Wn="popstate";function Po(r={}){function e(n,s){let{pathname:i,search:o,hash:a}=n.location;return Kr("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:Nt(s)}return Oo(e,t,null,r)}function N(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function ue(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Ao(){return Math.random().toString(36).substring(2,10)}function Hn(r,e){return{usr:r.state,key:r.key,idx:e}}function Kr(r,e,t=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?ht(e):e,state:t,key:e&&e.key||n||Ao()}}function Nt({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function ht(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substring(n),r=r.substring(0,n)),r&&(e.pathname=r)}return e}function Oo(r,e,t,n={}){let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,a="POP",l=null,c=u();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function u(){return(o.state||{idx:null}).idx}function h(){a="POP";let m=u(),v=m==null?null:m-c;c=m,l&&l({action:a,location:b.location,delta:v})}function f(m,v){a="PUSH";let x=Kr(b.location,m,v);c=u()+1;let w=Hn(x,c),S=b.createHref(x);try{o.pushState(w,"",S)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(S)}i&&l&&l({action:a,location:b.location,delta:1})}function y(m,v){a="REPLACE";let x=Kr(b.location,m,v);c=u();let w=Hn(x,c),S=b.createHref(x);o.replaceState(w,"",S),i&&l&&l({action:a,location:b.location,delta:0})}function p(m){let v=s.location.origin!=="null"?s.location.origin:s.location.href,x=typeof m=="string"?m:Nt(m);return x=x.replace(/ $/,"%20"),N(v,`No window.location.(origin|href) available to create URL for href: ${x}`),new URL(x,v)}let b={get action(){return a},get location(){return r(s,o)},listen(m){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(Wn,h),l=m,()=>{s.removeEventListener(Wn,h),l=null}},createHref(m){return e(s,m)},createURL:p,encodeLocation(m){let v=p(m);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:y,go(m){return o.go(m)}};return b}function ri(r,e,t="/"){return $o(r,e,t,!1)}function $o(r,e,t,n){let s=typeof e=="string"?ht(e):e,i=Oe(s.pathname||"/",t);if(i==null)return null;let o=ni(r);Io(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=Ho(i);a=qo(o[l],c,n)}return a}function ni(r,e=[],t=[],n=""){let s=(i,o,a)=>{let l={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(N(l.relativePath.startsWith(n),`Absolute route path "${l.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(n.length));let c=Ae([n,l.relativePath]),u=t.concat(l);i.children&&i.children.length>0&&(N(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),ni(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:zo(c,i.index),routesMeta:u})};return r.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let l of si(i.path))s(i,o,l)}),e}function si(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=si(n.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>r.startsWith("/")&&l===""?"/":l)}function Io(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:Mo(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var Lo=/^:[\w-]+$/,Do=3,Bo=2,No=1,Uo=10,Fo=-2,Jn=r=>r==="*";function zo(r,e){let t=r.split("/"),n=t.length;return t.some(Jn)&&(n+=Fo),e&&(n+=Bo),t.filter(s=>!Jn(s)).reduce((s,i)=>s+(Lo.test(i)?Do:i===""?No:Uo),n)}function Mo(r,e){return r.length===e.length&&r.slice(0,-1).every((n,s)=>n===e[s])?r[r.length-1]-e[e.length-1]:0}function qo(r,e,t=!1){let{routesMeta:n}=r,s={},i="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=pr({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!h&&c&&t&&!n[n.length-1].route.index&&(h=pr({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Ae([i,h.pathname]),pathnameBase:Go(Ae([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Ae([i,h.pathnameBase]))}return o}function pr(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=Wo(r.path,r.caseSensitive,r.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:n.reduce((c,{paramName:u,isOptional:h},f)=>{if(u==="*"){let p=a[f]||"";o=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const y=a[f];return h&&!y?c[u]=void 0:c[u]=(y||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:r}}function Wo(r,e=!1,t=!0){ue(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],s="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),s+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":r!==""&&r!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function Ho(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ue(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function Oe(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function Jo(r,e="/"){let{pathname:t,search:n="",hash:s=""}=typeof r=="string"?ht(r):r;return{pathname:t?t.startsWith("/")?t:Vo(t,e):e,search:Yo(n),hash:Xo(s)}}function Vo(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Ir(r,e,t,n){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Ko(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function mn(r){let e=Ko(r);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function gn(r,e,t,n=!1){let s;typeof r=="string"?s=ht(r):(s={...r},N(!s.pathname||!s.pathname.includes("?"),Ir("?","pathname","search",s)),N(!s.pathname||!s.pathname.includes("#"),Ir("#","pathname","hash",s)),N(!s.search||!s.search.includes("#"),Ir("#","search","hash",s)));let i=r===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=t;else{let h=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}a=h>=0?e[h]:"/"}let l=Jo(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Ae=r=>r.join("/").replace(/\/\/+/g,"/"),Go=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),Yo=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,Xo=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function Qo(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var ii=["POST","PUT","PATCH","DELETE"];new Set(ii);var Zo=["GET",...ii];new Set(Zo);var ft=g.createContext(null);ft.displayName="DataRouter";var _r=g.createContext(null);_r.displayName="DataRouterState";var oi=g.createContext({isTransitioning:!1});oi.displayName="ViewTransition";var ea=g.createContext(new Map);ea.displayName="Fetchers";var ta=g.createContext(null);ta.displayName="Await";var ye=g.createContext(null);ye.displayName="Navigation";var zt=g.createContext(null);zt.displayName="Location";var je=g.createContext({outlet:null,matches:[],isDataRoute:!1});je.displayName="Route";var yn=g.createContext(null);yn.displayName="RouteError";function ra(r,{relative:e}={}){N(pt(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=g.useContext(ye),{hash:s,pathname:i,search:o}=Mt(r,{relative:e}),a=i;return t!=="/"&&(a=i==="/"?t:Ae([t,i])),n.createHref({pathname:a,search:o,hash:s})}function pt(){return g.useContext(zt)!=null}function ae(){return N(pt(),"useLocation() may be used only in the context of a <Router> component."),g.useContext(zt).location}var ai="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function li(r){g.useContext(ye).static||g.useLayoutEffect(r)}function be(){let{isDataRoute:r}=g.useContext(je);return r?ma():na()}function na(){N(pt(),"useNavigate() may be used only in the context of a <Router> component.");let r=g.useContext(ft),{basename:e,navigator:t}=g.useContext(ye),{matches:n}=g.useContext(je),{pathname:s}=ae(),i=JSON.stringify(mn(n)),o=g.useRef(!1);return li(()=>{o.current=!0}),g.useCallback((l,c={})=>{if(ue(o.current,ai),!o.current)return;if(typeof l=="number"){t.go(l);return}let u=gn(l,JSON.parse(i),s,c.relative==="path");r==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:Ae([e,u.pathname])),(c.replace?t.replace:t.push)(u,c.state,c)},[e,t,i,s,r])}g.createContext(null);function Mt(r,{relative:e}={}){let{matches:t}=g.useContext(je),{pathname:n}=ae(),s=JSON.stringify(mn(t));return g.useMemo(()=>gn(r,JSON.parse(s),n,e==="path"),[r,s,n,e])}function sa(r,e){return ci(r,e)}function ci(r,e,t,n){var x;N(pt(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:i}=g.useContext(ye),{matches:o}=g.useContext(je),a=o[o.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",h=a&&a.route;{let w=h&&h.path||"";di(c,!h||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let f=ae(),y;if(e){let w=typeof e=="string"?ht(e):e;N(u==="/"||((x=w.pathname)==null?void 0:x.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${w.pathname}" was given in the \`location\` prop.`),y=w}else y=f;let p=y.pathname||"/",b=p;if(u!=="/"){let w=u.replace(/^\//,"").split("/");b="/"+p.replace(/^\//,"").split("/").slice(w.length).join("/")}let m=!i&&t&&t.matches&&t.matches.length>0?t.matches:ri(r,{pathname:b});ue(h||m!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),ue(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=ca(m&&m.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Ae([u,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?u:Ae([u,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,t,n);return e&&v?g.createElement(zt.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},v):v}function ia(){let r=pa(),e=Qo(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",r),o=g.createElement(g.Fragment,null,g.createElement("p",null,"💿 Hey developer 👋"),g.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",g.createElement("code",{style:i},"ErrorBoundary")," or"," ",g.createElement("code",{style:i},"errorElement")," prop on your route.")),g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),t?g.createElement("pre",{style:s},t):null,o)}var oa=g.createElement(ia,null),aa=class extends g.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?g.createElement(je.Provider,{value:this.props.routeContext},g.createElement(yn.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function la({routeContext:r,match:e,children:t}){let n=g.useContext(ft);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),g.createElement(je.Provider,{value:r},t)}function ca(r,e=[],t=null,n=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let s=r,i=t==null?void 0:t.errors;if(i!=null){let l=s.findIndex(c=>c.route.id&&(i==null?void 0:i[c.route.id])!==void 0);N(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,l+1))}let o=!1,a=-1;if(t)for(let l=0;l<s.length;l++){let c=s[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:u,errors:h}=t,f=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!h||h[c.route.id]===void 0);if(c.route.lazy||f){o=!0,a>=0?s=s.slice(0,a+1):s=[s[0]];break}}}return s.reduceRight((l,c,u)=>{let h,f=!1,y=null,p=null;t&&(h=i&&c.route.id?i[c.route.id]:void 0,y=c.route.errorElement||oa,o&&(a<0&&u===0?(di("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,p=null):a===u&&(f=!0,p=c.route.hydrateFallbackElement||null)));let b=e.concat(s.slice(0,u+1)),m=()=>{let v;return h?v=y:f?v=p:c.route.Component?v=g.createElement(c.route.Component,null):c.route.element?v=c.route.element:v=l,g.createElement(la,{match:c,routeContext:{outlet:l,matches:b,isDataRoute:t!=null},children:v})};return t&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?g.createElement(aa,{location:t.location,revalidation:t.revalidation,component:y,error:h,children:m(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):m()},null)}function bn(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function da(r){let e=g.useContext(ft);return N(e,bn(r)),e}function ua(r){let e=g.useContext(_r);return N(e,bn(r)),e}function ha(r){let e=g.useContext(je);return N(e,bn(r)),e}function vn(r){let e=ha(r),t=e.matches[e.matches.length-1];return N(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function fa(){return vn("useRouteId")}function pa(){var n;let r=g.useContext(yn),e=ua("useRouteError"),t=vn("useRouteError");return r!==void 0?r:(n=e.errors)==null?void 0:n[t]}function ma(){let{router:r}=da("useNavigate"),e=vn("useNavigate"),t=g.useRef(!1);return li(()=>{t.current=!0}),g.useCallback(async(s,i={})=>{ue(t.current,ai),t.current&&(typeof s=="number"?r.navigate(s):await r.navigate(s,{fromRouteId:e,...i}))},[r,e])}var Vn={};function di(r,e,t){!e&&!Vn[r]&&(Vn[r]=!0,ue(!1,t))}g.memo(ga);function ga({routes:r,future:e,state:t}){return ci(r,void 0,t,e)}function ui({to:r,replace:e,state:t,relative:n}){N(pt(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=g.useContext(ye);ue(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=g.useContext(je),{pathname:o}=ae(),a=be(),l=gn(r,mn(i),o,n==="path"),c=JSON.stringify(l);return g.useEffect(()=>{a(JSON.parse(c),{replace:e,state:t,relative:n})},[a,c,n,e,t]),null}function F(r){N(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ya({basename:r="/",children:e=null,location:t,navigationType:n="POP",navigator:s,static:i=!1}){N(!pt(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=r.replace(/^\/*/,"/"),a=g.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof t=="string"&&(t=ht(t));let{pathname:l="/",search:c="",hash:u="",state:h=null,key:f="default"}=t,y=g.useMemo(()=>{let p=Oe(l,o);return p==null?null:{location:{pathname:p,search:c,hash:u,state:h,key:f},navigationType:n}},[o,l,c,u,h,f,n]);return ue(y!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:g.createElement(ye.Provider,{value:a},g.createElement(zt.Provider,{children:e,value:y}))}function ba({children:r,location:e}){return sa(Gr(r),e)}function Gr(r,e=[]){let t=[];return g.Children.forEach(r,(n,s)=>{if(!g.isValidElement(n))return;let i=[...e,s];if(n.type===g.Fragment){t.push.apply(t,Gr(n.props.children,i));return}N(n.type===F,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),N(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Gr(n.props.children,i)),t.push(o)}),t}var cr="get",dr="application/x-www-form-urlencoded";function xr(r){return r!=null&&typeof r.tagName=="string"}function va(r){return xr(r)&&r.tagName.toLowerCase()==="button"}function wa(r){return xr(r)&&r.tagName.toLowerCase()==="form"}function _a(r){return xr(r)&&r.tagName.toLowerCase()==="input"}function xa(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function Sa(r,e){return r.button===0&&(!e||e==="_self")&&!xa(r)}function Yr(r=""){return new URLSearchParams(typeof r=="string"||Array.isArray(r)||r instanceof URLSearchParams?r:Object.keys(r).reduce((e,t)=>{let n=r[t];return e.concat(Array.isArray(n)?n.map(s=>[t,s]):[[t,n]])},[]))}function ja(r,e){let t=Yr(r);return e&&e.forEach((n,s)=>{t.has(s)||e.getAll(s).forEach(i=>{t.append(s,i)})}),t}var Gt=null;function Ea(){if(Gt===null)try{new FormData(document.createElement("form"),0),Gt=!1}catch{Gt=!0}return Gt}var ka=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Lr(r){return r!=null&&!ka.has(r)?(ue(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${dr}"`),null):r}function Ca(r,e){let t,n,s,i,o;if(wa(r)){let a=r.getAttribute("action");n=a?Oe(a,e):null,t=r.getAttribute("method")||cr,s=Lr(r.getAttribute("enctype"))||dr,i=new FormData(r)}else if(va(r)||_a(r)&&(r.type==="submit"||r.type==="image")){let a=r.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=r.getAttribute("formaction")||a.getAttribute("action");if(n=l?Oe(l,e):null,t=r.getAttribute("formmethod")||a.getAttribute("method")||cr,s=Lr(r.getAttribute("formenctype"))||Lr(a.getAttribute("enctype"))||dr,i=new FormData(a,r),!Ea()){let{name:c,type:u,value:h}=r;if(u==="image"){let f=c?`${c}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else c&&i.append(c,h)}}else{if(xr(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=cr,n=null,s=dr,o=r}return i&&s==="text/plain"&&(o=i,i=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:i,body:o}}function wn(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}async function Ra(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ta(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function Pa(r,e,t){let n=await Promise.all(r.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await Ra(i,t);return o.links?o.links():[]}return[]}));return Ia(n.flat(1).filter(Ta).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Kn(r,e,t,n,s,i){let o=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,a=(l,c)=>{var u;return t[c].pathname!==l.pathname||((u=t[c].route.path)==null?void 0:u.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):i==="data"?e.filter((l,c)=>{var h;let u=n.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let f=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((h=t[0])==null?void 0:h.params)||{},nextUrl:new URL(r,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function Aa(r,e,{includeHydrateFallback:t}={}){return Oa(r.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function Oa(r){return[...new Set(r)]}function $a(r){let e={},t=Object.keys(r).sort();for(let n of t)e[n]=r[n];return e}function Ia(r,e){let t=new Set;return new Set(e),r.reduce((n,s)=>{let i=JSON.stringify($a(s));return t.has(i)||(t.add(i),n.push({key:i,link:s})),n},[])}var La=new Set([100,101,204,205]);function Da(r,e){let t=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return t.pathname==="/"?t.pathname="_root.data":e&&Oe(t.pathname,e)==="/"?t.pathname=`${e.replace(/\/$/,"")}/_root.data`:t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function hi(){let r=g.useContext(ft);return wn(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function Ba(){let r=g.useContext(_r);return wn(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var _n=g.createContext(void 0);_n.displayName="FrameworkContext";function fi(){let r=g.useContext(_n);return wn(r,"You must render this element inside a <HydratedRouter> element"),r}function Na(r,e){let t=g.useContext(_n),[n,s]=g.useState(!1),[i,o]=g.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:h}=e,f=g.useRef(null);g.useEffect(()=>{if(r==="render"&&o(!0),r==="viewport"){let b=v=>{v.forEach(x=>{o(x.isIntersecting)})},m=new IntersectionObserver(b,{threshold:.5});return f.current&&m.observe(f.current),()=>{m.disconnect()}}},[r]),g.useEffect(()=>{if(n){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[n]);let y=()=>{s(!0)},p=()=>{s(!1),o(!1)};return t?r!=="intent"?[i,f,{}]:[i,f,{onFocus:Et(a,y),onBlur:Et(l,p),onMouseEnter:Et(c,y),onMouseLeave:Et(u,p),onTouchStart:Et(h,y)}]:[!1,f,{}]}function Et(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function Ua({page:r,...e}){let{router:t}=hi(),n=g.useMemo(()=>ri(t.routes,r,t.basename),[t.routes,r,t.basename]);return n?g.createElement(za,{page:r,matches:n,...e}):null}function Fa(r){let{manifest:e,routeModules:t}=fi(),[n,s]=g.useState([]);return g.useEffect(()=>{let i=!1;return Pa(r,e,t).then(o=>{i||s(o)}),()=>{i=!0}},[r,e,t]),n}function za({page:r,matches:e,...t}){let n=ae(),{manifest:s,routeModules:i}=fi(),{basename:o}=hi(),{loaderData:a,matches:l}=Ba(),c=g.useMemo(()=>Kn(r,e,l,s,n,"data"),[r,e,l,s,n]),u=g.useMemo(()=>Kn(r,e,l,s,n,"assets"),[r,e,l,s,n]),h=g.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let p=new Set,b=!1;if(e.forEach(v=>{var w;let x=s.routes[v.route.id];!x||!x.hasLoader||(!c.some(S=>S.route.id===v.route.id)&&v.route.id in a&&((w=i[v.route.id])!=null&&w.shouldRevalidate)||x.hasClientLoader?b=!0:p.add(v.route.id))}),p.size===0)return[];let m=Da(r,o);return b&&p.size>0&&m.searchParams.set("_routes",e.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[m.pathname+m.search]},[o,a,n,s,c,e,r,i]),f=g.useMemo(()=>Aa(u,s),[u,s]),y=Fa(u);return g.createElement(g.Fragment,null,h.map(p=>g.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...t})),f.map(p=>g.createElement("link",{key:p,rel:"modulepreload",href:p,...t})),y.map(({key:p,link:b})=>g.createElement("link",{key:p,...b})))}function Ma(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var pi=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{pi&&(window.__reactRouterVersion="7.5.1")}catch{}function qa({basename:r,children:e,window:t}){let n=g.useRef();n.current==null&&(n.current=Po({window:t,v5Compat:!0}));let s=n.current,[i,o]=g.useState({action:s.action,location:s.location}),a=g.useCallback(l=>{g.startTransition(()=>o(l))},[o]);return g.useLayoutEffect(()=>s.listen(a),[s,a]),g.createElement(ya,{basename:r,children:e,location:i.location,navigationType:i.action,navigator:s})}var mi=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ne=g.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h,...f},y){let{basename:p}=g.useContext(ye),b=typeof c=="string"&&mi.test(c),m,v=!1;if(typeof c=="string"&&b&&(m=c,pi))try{let D=new URL(window.location.href),H=c.startsWith("//")?new URL(D.protocol+c):new URL(c),le=Oe(H.pathname,p);H.origin===D.origin&&le!=null?c=le+H.search+H.hash:v=!0}catch{ue(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let x=ra(c,{relative:s}),[w,S,E]=Na(n,f),P=Va(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:h});function O(D){e&&e(D),D.defaultPrevented||P(D)}let L=g.createElement("a",{...f,...E,href:m||x,onClick:v||i?e:O,ref:Ma(y,S),target:l,"data-discover":!b&&t==="render"?"true":void 0});return w&&!b?g.createElement(g.Fragment,null,L,g.createElement(Ua,{page:x})):L});Ne.displayName="Link";var Wa=g.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...c},u){let h=Mt(o,{relative:c.relative}),f=ae(),y=g.useContext(_r),{navigator:p,basename:b}=g.useContext(ye),m=y!=null&&Qa(h)&&a===!0,v=p.encodeLocation?p.encodeLocation(h).pathname:h.pathname,x=f.pathname,w=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;t||(x=x.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&b&&(w=Oe(w,b)||w);const S=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let E=x===v||!s&&x.startsWith(v)&&x.charAt(S)==="/",P=w!=null&&(w===v||!s&&w.startsWith(v)&&w.charAt(v.length)==="/"),O={isActive:E,isPending:P,isTransitioning:m},L=E?e:void 0,D;typeof n=="function"?D=n(O):D=[n,E?"active":null,P?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let H=typeof i=="function"?i(O):i;return g.createElement(Ne,{...c,"aria-current":L,className:D,ref:u,style:H,to:o,viewTransition:a},typeof l=="function"?l(O):l)});Wa.displayName="NavLink";var Ha=g.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:s,state:i,method:o=cr,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:h,...f},y)=>{let p=Ya(),b=Xa(a,{relative:c}),m=o.toLowerCase()==="get"?"get":"post",v=typeof a=="string"&&mi.test(a),x=w=>{if(l&&l(w),w.defaultPrevented)return;w.preventDefault();let S=w.nativeEvent.submitter,E=(S==null?void 0:S.getAttribute("formmethod"))||o;p(S||w.currentTarget,{fetcherKey:e,method:E,navigate:t,replace:s,state:i,relative:c,preventScrollReset:u,viewTransition:h})};return g.createElement("form",{ref:y,method:m,action:b,onSubmit:n?l:x,...f,"data-discover":!v&&r==="render"?"true":void 0})});Ha.displayName="Form";function Ja(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function gi(r){let e=g.useContext(ft);return N(e,Ja(r)),e}function Va(r,{target:e,replace:t,state:n,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=be(),l=ae(),c=Mt(r,{relative:i});return g.useCallback(u=>{if(Sa(u,e)){u.preventDefault();let h=t!==void 0?t:Nt(l)===Nt(c);a(r,{replace:h,state:n,preventScrollReset:s,relative:i,viewTransition:o})}},[l,a,c,t,n,e,r,s,i,o])}function yi(r){ue(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=g.useRef(Yr(r)),t=g.useRef(!1),n=ae(),s=g.useMemo(()=>ja(n.search,t.current?null:e.current),[n.search]),i=be(),o=g.useCallback((a,l)=>{const c=Yr(typeof a=="function"?a(s):a);t.current=!0,i("?"+c,l)},[i,s]);return[s,o]}var Ka=0,Ga=()=>`__${String(++Ka)}__`;function Ya(){let{router:r}=gi("useSubmit"),{basename:e}=g.useContext(ye),t=fa();return g.useCallback(async(n,s={})=>{let{action:i,method:o,encType:a,formData:l,body:c}=Ca(n,e);if(s.navigate===!1){let u=s.fetcherKey||Ga();await r.fetch(u,t,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await r.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[r,e,t])}function Xa(r,{relative:e}={}){let{basename:t}=g.useContext(ye),n=g.useContext(je);N(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),i={...Mt(r||".",{relative:e})},o=ae();if(r==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(h=>h).forEach(h=>a.append("index",h));let u=a.toString();i.search=u?`?${u}`:""}}return(!r||r===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Ae([t,i.pathname])),Nt(i)}function Qa(r,e={}){let t=g.useContext(oi);N(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=gi("useViewTransitionState"),s=Mt(r,{relative:e.relative});if(!t.isTransitioning)return!1;let i=Oe(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=Oe(t.nextLocation.pathname,n)||t.nextLocation.pathname;return pr(s.pathname,o)!=null||pr(s.pathname,i)!=null}new TextEncoder;[...La];var Za=Eo();const el=ti(Za),tl="modulepreload",rl=function(r){return"/"+r},Gn={},dt=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let o=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=o(t.map(c=>{if(c=rl(c),c in Gn)return;Gn[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":tl,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((y,p)=>{f.addEventListener("load",y),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},nl=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>dt(async()=>{const{default:n}=await Promise.resolve().then(()=>mt);return{default:n}},[]).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class xn extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class sl extends xn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class il extends xn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ol extends xn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Xr;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Xr||(Xr={}));var al=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};class ll{constructor(e,{headers:t={},customFetch:n,region:s=Xr.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=nl(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return al(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let a={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let c;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):typeof o=="string"?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:c}).catch(p=>{throw new sl(p)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new il(u);if(!u.ok)throw new ol(u);let f=((n=u.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),y;return f==="application/json"?y=yield u.json():f==="application/octet-stream"?y=yield u.blob():f==="text/event-stream"?y=u:f==="multipart/form-data"?y=yield u.formData():y=yield u.text(),{data:y,error:null}}catch(s){return{data:null,error:s}}})}}var V={},et={},tt={},rt={},nt={},st={},cl=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ut=cl();const dl=ut.fetch,bi=ut.fetch.bind(ut),vi=ut.Headers,ul=ut.Request,hl=ut.Response,mt=Object.freeze(Object.defineProperty({__proto__:null,Headers:vi,Request:ul,Response:hl,default:bi,fetch:dl},Symbol.toStringTag,{value:"Module"})),fl=ko(mt);var Yt={},Yn;function wi(){if(Yn)return Yt;Yn=1,Object.defineProperty(Yt,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Yt.default=r,Yt}var Xn;function _i(){if(Xn)return st;Xn=1;var r=st&&st.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(st,"__esModule",{value:!0});const e=r(fl),t=r(wi());class n{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,f;let y=null,p=null,b=null,m=c.status,v=c.statusText;if(c.ok){if(this.method!=="HEAD"){const E=await c.text();E===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?p=E:p=JSON.parse(E))}const w=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),S=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");w&&S&&S.length>1&&(b=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(y={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,b=null,m=406,v="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const w=await c.text();try{y=JSON.parse(w),Array.isArray(y)&&c.status===404&&(p=[],y=null,m=200,v="OK")}catch{c.status===404&&w===""?(m=204,v="No Content"):y={message:w}}if(y&&this.isMaybeSingle&&(!((f=y==null?void 0:y.details)===null||f===void 0)&&f.includes("0 rows"))&&(y=null,m=200,v="OK"),y&&this.shouldThrowOnError)throw new t.default(y)}return{error:y,data:p,count:b,status:m,statusText:v}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,f;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=c==null?void 0:c.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return st.default=n,st}var Qn;function xi(){if(Qn)return nt;Qn=1;var r=nt&&nt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(nt,"__esModule",{value:!0});const e=r(_i());class t extends e.default{select(s){let i=!1;const o=(s??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(c,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[s?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${f}"; options=${h};`,c==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return nt.default=t,nt}var Zn;function Sn(){if(Zn)return rt;Zn=1;var r=rt&&rt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(rt,"__esModule",{value:!0});const e=r(xi());class t extends e.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${l}fts${c}.${i}`),this}match(s){return Object.entries(s).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(s,i,o){return this.url.searchParams.append(s,`not.${i}.${o}`),this}or(s,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${s})`),this}filter(s,i,o){return this.url.searchParams.append(s,`${i}.${o}`),this}}return rt.default=t,rt}var es;function Si(){if(es)return tt;es=1;var r=tt&&tt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(tt,"__esModule",{value:!0});const e=r(Sn());class t{constructor(s,{headers:i={},schema:o,fetch:a}){this.url=s,this.headers=i,this.schema=o,this.fetch=a}select(s,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let l=!1;const c=(s??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:i,defaultToNull:o=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),o||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(s)){const c=s.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),a&&u.push(`count=${a}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(s)){const h=s.reduce((f,y)=>f.concat(Object.keys(y)),[]);if(h.length>0){const f=[...new Set(h)].map(y=>`"${y}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const i="DELETE",o=[];return s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return tt.default=t,tt}var kt={},Ct={},ts;function pl(){return ts||(ts=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.version=void 0,Ct.version="0.0.0-automated"),Ct}var rs;function ml(){if(rs)return kt;rs=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.DEFAULT_HEADERS=void 0;const r=pl();return kt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`},kt}var ns;function gl(){if(ns)return et;ns=1;var r=et&&et.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(et,"__esModule",{value:!0});const e=r(Si()),t=r(Sn()),n=ml();class s{constructor(o,{headers:a={},schema:l,fetch:c}={}){this.url=o,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),a),this.schemaName=l,this.fetch=c}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new s(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:c=!1,count:u}={}){let h;const f=new URL(`${this.url}/rpc/${o}`);let y;l||c?(h=l?"HEAD":"GET",Object.entries(a).filter(([b,m])=>m!==void 0).map(([b,m])=>[b,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([b,m])=>{f.searchParams.append(b,m)})):(h="POST",y=a);const p=Object.assign({},this.headers);return u&&(p.Prefer=`count=${u}`),new t.default({method:h,url:f,headers:p,schema:this.schemaName,body:y,fetch:this.fetch,allowEmpty:!1})}}return et.default=s,et}var ss;function yl(){if(ss)return V;ss=1;var r=V&&V.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(V,"__esModule",{value:!0}),V.PostgrestError=V.PostgrestBuilder=V.PostgrestTransformBuilder=V.PostgrestFilterBuilder=V.PostgrestQueryBuilder=V.PostgrestClient=void 0;const e=r(gl());V.PostgrestClient=e.default;const t=r(Si());V.PostgrestQueryBuilder=t.default;const n=r(Sn());V.PostgrestFilterBuilder=n.default;const s=r(xi());V.PostgrestTransformBuilder=s.default;const i=r(_i());V.PostgrestBuilder=i.default;const o=r(wi());return V.PostgrestError=o.default,V.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:i.default,PostgrestError:o.default},V}var bl=yl();const vl=ti(bl),{PostgrestClient:wl,PostgrestQueryBuilder:Pp,PostgrestFilterBuilder:Ap,PostgrestTransformBuilder:Op,PostgrestBuilder:$p,PostgrestError:Ip}=vl,_l="2.11.2",xl={"X-Client-Info":`realtime-js/${_l}`},Sl="1.0.0",ji=1e4,jl=1e3;var ct;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(ct||(ct={}));var ie;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(ie||(ie={}));var ge;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(ge||(ge={}));var Qr;(function(r){r.websocket="websocket"})(Qr||(Qr={}));var We;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(We||(We={}));class El{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+s));o=o+s;const l=n.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class Ei{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var I;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(I||(I={}));const is=(r,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,o)=>(i[o]=kl(o,r,e,s),i),{})},kl=(r,e,t,n)=>{const s=e.find(a=>a.name===r),i=s==null?void 0:s.type,o=t[r];return i&&!n.includes(i)?ki(i,o):Zr(o)},ki=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Pl(e,t)}switch(r){case I.bool:return Cl(e);case I.float4:case I.float8:case I.int2:case I.int4:case I.int8:case I.numeric:case I.oid:return Rl(e);case I.json:case I.jsonb:return Tl(e);case I.timestamp:return Al(e);case I.abstime:case I.date:case I.daterange:case I.int4range:case I.int8range:case I.money:case I.reltime:case I.text:case I.time:case I.timestamptz:case I.timetz:case I.tsrange:case I.tstzrange:return Zr(e);default:return Zr(e)}},Zr=r=>r,Cl=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Rl=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Tl=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Pl=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let i;const o=r.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>ki(e,a))}return r},Al=r=>typeof r=="string"?r.replace(" ","T"):r,Ci=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Dr{constructor(e,t,n={},s=ji){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var os;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(os||(os={}));class Lt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Lt.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=Lt.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Lt.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const f=u.map(m=>m.presence_ref),y=h.map(m=>m.presence_ref),p=u.filter(m=>y.indexOf(m.presence_ref)<0),b=h.filter(m=>f.indexOf(m.presence_ref)<0);p.length>0&&(a[c]=p),b.length>0&&(l[c]=b)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},n,s)}static syncDiff(e,t,n,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(y=>y.presence_ref),f=u.filter(y=>h.indexOf(y.presence_ref)<0);e[a].unshift(...f)}n(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,s(a,c,l),c.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var as;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(as||(as={}));var ls;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(ls||(ls={}));var Pe;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Pe||(Pe={}));class jn{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=ie.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Dr(this,ge.join,this.params,this.timeout),this.rejoinTimer=new Ei(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ie.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ie.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ie.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ie.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ge.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Lt(this),this.broadcastEndpointURL=Ci(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(u=>e==null?void 0:e(Pe.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(Pe.CLOSED));const l={},c={broadcast:i,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(Pe.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,y=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,p=[];for(let b=0;b<y;b++){const m=f[b],{filter:{event:v,schema:x,table:w,filter:S}}=m,E=u&&u[b];if(E&&E.event===v&&E.schema===x&&E.table===w&&E.filter===S)p.push(Object.assign(Object.assign({},m),{id:E.id}));else{this.unsubscribe(),e==null||e(Pe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(Pe.SUBSCRIBED);return}}).receive("error",u=>{e==null||e(Pe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Pe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ie.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ge.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const s=new Dr(this,ge.leave,{},e);s.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(e,t,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Dr(this,e,t,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=ge;if(n&&[a,l,c,u].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,t,n);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(y=>{var p,b,m;return((p=y.filter)===null||p===void 0?void 0:p.event)==="*"||((m=(b=y.filter)===null||b===void 0?void 0:b.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===o}).map(y=>y.callback(f,n)):(i=this.bindings[o])===null||i===void 0||i.filter(y=>{var p,b,m,v,x,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const S=y.id,E=(p=y.filter)===null||p===void 0?void 0:p.event;return S&&((b=t.ids)===null||b===void 0?void 0:b.includes(S))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const S=(x=(v=y==null?void 0:y.filter)===null||v===void 0?void 0:v.event)===null||x===void 0?void 0:x.toLocaleLowerCase();return S==="*"||S===((w=t==null?void 0:t.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:b,table:m,commit_timestamp:v,type:x,errors:w}=p;f=Object.assign(Object.assign({},{schema:b,table:m,commit_timestamp:v,eventType:x,new:{},old:{},errors:w}),this._getPayloadRecords(p))}y.callback(f,n)})}_isClosed(){return this.state===ie.closed}_isJoined(){return this.state===ie.joined}_isJoining(){return this.state===ie.joining}_isLeaving(){return this.state===ie.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&jn.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ge.close,{},e)}_onError(e){this._on(ge.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ie.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=is(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=is(e.columns,e.old_record)),t}}const Ol=()=>{},$l=typeof WebSocket<"u",Il=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ll{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=xl,this.params={},this.timeout=ji,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Ol,this.conn=null,this.sendBuffer=[],this.serializer=new El,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>dt(async()=>{const{default:l}=await Promise.resolve().then(()=>mt);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Qr.websocket}`,this.httpEndpoint=Ci(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ei(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if($l){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Dl(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),dt(async()=>{const{default:e}=await import("./browser-BrKw3Rt1.js").then(t=>t.b);return{default:e}},__vite__mapDeps([0,1])).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Sl}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ct.connecting:return We.Connecting;case ct.open:return We.Open;case ct.closing:return We.Closing;default:return We.Closed}}isConnected(){return this.connectionState()===We.Open}channel(e,t={config:{}}){const n=new jn(`realtime:${e}`,t,this);return this.channels.push(n),n}push(e){const{topic:t,event:n,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let n=null;try{n=JSON.parse(atob(t.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=t,this.channels.forEach(s=>{t&&s.updateJoinPayload({access_token:t}),s.joinedOnce&&s._isJoined()&&s._push(ge.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(jl,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:s,payload:i,ref:o}=t;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,i),this.channels.filter(a=>a._isMember(n)).forEach(a=>a._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ge.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([Il],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class Dl{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ct.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class En extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function K(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Bl extends En{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class en extends En{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Nl=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};const Ri=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>dt(async()=>{const{default:n}=await Promise.resolve().then(()=>mt);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},Ul=()=>Nl(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield dt(()=>Promise.resolve().then(()=>mt),void 0)).Response:Response}),tn=r=>{if(Array.isArray(r))return r.map(t=>tn(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=tn(n)}),e};var Ke=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};const Br=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Fl=(r,e,t)=>Ke(void 0,void 0,void 0,function*(){const n=yield Ul();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(s=>{e(new Bl(Br(s),r.status||500))}).catch(s=>{e(new en(Br(s),s))}):e(new en(Br(r),r))}),zl=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),t))};function qt(r,e,t,n,s,i){return Ke(this,void 0,void 0,function*(){return new Promise((o,a)=>{r(t,zl(e,n,s,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Fl(l,a,n))})})}function mr(r,e,t,n){return Ke(this,void 0,void 0,function*(){return qt(r,"GET",e,t,n)})}function De(r,e,t,n,s){return Ke(this,void 0,void 0,function*(){return qt(r,"POST",e,n,s,t)})}function Ml(r,e,t,n,s){return Ke(this,void 0,void 0,function*(){return qt(r,"PUT",e,n,s,t)})}function ql(r,e,t,n){return Ke(this,void 0,void 0,function*(){return qt(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function Ti(r,e,t,n,s){return Ke(this,void 0,void 0,function*(){return qt(r,"DELETE",e,n,s,t)})}var ee=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};const Wl={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Hl{constructor(e,t={},n,s){this.url=e,this.headers=t,this.bucketId=n,this.fetch=Ri(s)}uploadOrUpdate(e,t,n,s){return ee(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},cs),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield h.json();return h.ok?{data:{path:c,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(K(i))return{data:null,error:i};throw i}})}upload(e,t,n){return ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,s){return ee(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:cs.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:u}),f=yield h.json();return h.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(l){if(K(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return ee(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield De(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new En("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}})}update(e,t,n){return ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return ee(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}copy(e,t,n){return ee(this,void 0,void 0,function*(){try{return{data:{path:(yield De(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,n){return ee(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield De(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,n){return ee(this,void 0,void 0,function*(){try{const s=yield De(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}download(e,t){return ee(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield mr(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(K(a))return{data:null,error:a};throw a}})}info(e){return ee(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield mr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:tn(n),error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}})}exists(e){return ee(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield ql(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(K(n)&&n instanceof en){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${c}`)}}}remove(e){return ee(this,void 0,void 0,function*(){try{return{data:yield Ti(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}list(e,t,n){return ee(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Wl),t),{prefix:e||""});return{data:yield De(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Jl="2.7.1",Vl={"X-Client-Info":`storage-js/${Jl}`};var it=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};class Kl{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},Vl),t),this.fetch=Ri(n)}listBuckets(){return it(this,void 0,void 0,function*(){try{return{data:yield mr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(K(e))return{data:null,error:e};throw e}})}getBucket(e){return it(this,void 0,void 0,function*(){try{return{data:yield mr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return it(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return it(this,void 0,void 0,function*(){try{return{data:yield Ml(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}})}emptyBucket(e){return it(this,void 0,void 0,function*(){try{return{data:yield De(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}deleteBucket(e){return it(this,void 0,void 0,function*(){try{return{data:yield Ti(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}}class Gl extends Kl{constructor(e,t={},n){super(e,t,n)}from(e){return new Hl(this.url,this.headers,e,this.fetch)}}const Yl="2.49.4";let It="";typeof Deno<"u"?It="deno":typeof document<"u"?It="web":typeof navigator<"u"&&navigator.product==="ReactNative"?It="react-native":It="node";const Xl={"X-Client-Info":`supabase-js-${It}/${Yl}`},Ql={headers:Xl},Zl={schema:"public"},ec={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},tc={};var rc=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};const nc=r=>{let e;return r?e=r:typeof fetch>"u"?e=bi:e=fetch,(...t)=>e(...t)},sc=()=>typeof Headers>"u"?vi:Headers,ic=(r,e,t)=>{const n=nc(t),s=sc();return(i,o)=>rc(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:r;let c=new s(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},o),{headers:c}))})};var oc=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};function ac(r){return r.replace(/\/$/,"")}function lc(r,e){const{db:t,auth:n,realtime:s,global:i}=r,{db:o,auth:a,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},o),t),auth:Object.assign(Object.assign({},a),n),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},c),i),accessToken:()=>oc(this,void 0,void 0,function*(){return""})};return r.accessToken?u.accessToken=r.accessToken:delete u.accessToken,u}const Pi="2.69.1",lt=30*1e3,rn=3,Nr=rn*lt,cc="http://localhost:9999",dc="supabase.auth.token",uc={"X-Client-Info":`gotrue-js/${Pi}`},nn="X-Supabase-Api-Version",Ai={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},hc=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,fc=6e5;class kn extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function C(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class pc extends kn{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function mc(r){return C(r)&&r.name==="AuthApiError"}class Oi extends kn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ue extends kn{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class Ie extends Ue{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function gc(r){return C(r)&&r.name==="AuthSessionMissingError"}class Ur extends Ue{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Xt extends Ue{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Qt extends Ue{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function yc(r){return C(r)&&r.name==="AuthImplicitGrantRedirectError"}class ds extends Ue{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class sn extends Ue{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Fr(r){return C(r)&&r.name==="AuthRetryableFetchError"}class us extends Ue{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Dt extends Ue{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),fs=` 	
\r=`.split(""),bc=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<fs.length;e+=1)r[fs[e].charCodeAt(0)]=-2;for(let e=0;e<hs.length;e+=1)r[hs[e].charCodeAt(0)]=e;return r})();function $i(r,e,t){const n=bc[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function ps(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{_c(o,n,t)};for(let o=0;o<r.length;o+=1)$i(r.charCodeAt(o),s,i);return e.join("")}function vc(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function wc(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}vc(n,e)}}function _c(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if((r>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function xc(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<r.length;s+=1)$i(r.charCodeAt(s),t,n);return new Uint8Array(e)}function Sc(r){const e=[];return wc(r,t=>e.push(t)),new Uint8Array(e)}function jc(r){return Math.round(Date.now()/1e3)+r}function Ec(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const Se=()=>typeof window<"u"&&typeof document<"u",Me={tested:!1,writable:!1},Bt=()=>{if(!Se())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Me.tested)return Me.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Me.tested=!0,Me.writable=!0}catch{Me.tested=!0,Me.writable=!1}return Me.writable};function kc(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const Ii=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>dt(async()=>{const{default:n}=await Promise.resolve().then(()=>mt);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},Cc=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Li=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Zt=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},er=async(r,e)=>{await r.removeItem(e)};class Sr{constructor(){this.promise=new Sr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Sr.promiseConstructor=Promise;function zr(r){const e=r.split(".");if(e.length!==3)throw new Dt("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!hc.test(e[n]))throw new Dt("JWT not in base64url format");return{header:JSON.parse(ps(e[0])),payload:JSON.parse(ps(e[1])),signature:xc(e[2]),raw:{header:e[0],payload:e[1]}}}async function Rc(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Tc(r,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await r(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function Pc(r){return("0"+r.toString(16)).substr(-2)}function Ac(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Pc).join("")}async function Oc(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function $c(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Oc(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ot(r,e,t=!1){const n=Ac();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await Li(r,`${e}-code-verifier`,s);const i=await $c(n);return[i,n===i?"plain":"s256"]}const Ic=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Lc(r){const e=r.headers.get(nn);if(!e||!e.match(Ic))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Dc(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Bc(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var Nc=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};const qe=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Uc=[502,503,504];async function ms(r){var e;if(!Cc(r))throw new sn(qe(r),0);if(Uc.includes(r.status))throw new sn(qe(r),r.status);let t;try{t=await r.json()}catch(i){throw new Oi(qe(i),i)}let n;const s=Lc(r);if(s&&s.getTime()>=Ai["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new us(qe(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Ie}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new us(qe(t),r.status,t.weak_password.reasons);throw new pc(qe(t),r.status||500,n)}const Fc=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function T(r,e,t,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[nn]||(i[nn]=Ai["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await zc(r,e,t+a,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function zc(r,e,t,n,s,i){const o=Fc(e,n,s,i);let a;try{a=await r(t,Object.assign({},o))}catch(l){throw console.error(l),new sn(qe(l),0)}if(a.ok||await ms(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(l){await ms(l)}}function Le(r){var e;let t=null;Hc(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=jc(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function gs(r){const e=Le(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Be(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Mc(r){return{data:r,error:null}}function qc(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i}=r,o=Nc(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Wc(r){return r}function Hc(r){return r.access_token&&r.refresh_token&&r.expires_in}var Jc=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};class Vc{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=Ii(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await T(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(C(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await T(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Be})}catch(n){if(C(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=Jc(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await T(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:qc,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(C(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await T(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Be})}catch(t){if(C(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await T(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Wc});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return y.length>0&&(y.forEach(p=>{const b=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(p.split(";")[1].split("=")[1]);c[`${m}Page`]=b}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(C(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await T(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Be})}catch(t){if(C(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await T(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Be})}catch(n){if(C(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){try{return await T(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Be})}catch(n){if(C(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:t,error:n}=await T(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(C(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await T(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(C(t))return{data:null,error:t};throw t}}}const Kc={getItem:r=>Bt()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{Bt()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{Bt()&&globalThis.localStorage.removeItem(r)}};function ys(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Gc(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const at={debug:!!(globalThis&&Bt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Di extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Yc extends Di{}async function Xc(r,e,t){at.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),at.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){at.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,s.name);try{return await t()}finally{at.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,s.name)}}else{if(e===0)throw at.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Yc(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(at.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Gc();const Qc={url:cc,storageKey:dc,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:uc,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function bs(r,e,t){return await t()}class Ut{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ut.nextInstanceID,Ut.nextInstanceID+=1,this.instanceID>0&&Se()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Qc),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Vc({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Ii(s.fetch),this.lock=s.lock||bs,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Se()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Xc:this.lock=bs,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Bt()?this.storage=Kc:(this.memoryStorage={},this.storage=ys(this.memoryStorage)):(this.memoryStorage={},this.storage=ys(this.memoryStorage)),Se()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Pi}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=kc(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Se()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),yc(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return C(t)?{error:t}:{error:new Oi("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const i=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Le}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(C(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,n,s;try{let i;if("email"in e){const{email:u,password:h,options:f}=e;let y=null,p=null;this.flowType==="pkce"&&([y,p]=await ot(this.storage,this.storageKey)),i=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:y,code_challenge_method:p},xform:Le})}else if("phone"in e){const{phone:u,password:h,options:f}=e;i=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Le})}else throw new Xt("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(C(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:gs})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:gs})}else throw new Xt("You must provide either an email or phone number and a password");const{data:n,error:s}=t;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ur}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(C(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Zt(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{const{data:i,error:o}=await T(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Le});if(await er(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ur}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(C(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:i,nonce:o}=e,a=await T(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Le}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Ur}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(C(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await ot(this.storage,this.storageKey));const{error:h}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Xt("You must provide either an email or phone number.")}catch(a){if(C(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,n;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await T(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Le});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(C(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await ot(this.storage,this.storageKey)),await T(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Mc})}catch(i){if(C(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Ie;const{error:s}=await T(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(C(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:o}=await T(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:o,error:a}=await T(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Xt("You must provide either an email or phone number and a type")}catch(t){if(C(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Zt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Nr:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Be}):await this._useSession(async t=>{var n,s,i;const{data:o,error:a}=t;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ie}:await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Be})})}catch(t){if(C(t))return gc(t)&&(await this._removeSession(),await er(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new Ie;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await ot(this.storage,this.storageKey));const{data:c,error:u}=await T(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Be});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(C(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ie;const t=Date.now()/1e3;let n=t,s=!0,i=null;const{payload:o}=zr(e.access_token);if(o.exp&&(n=o.exp,s=n<=t),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(C(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Ie;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(C(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Se())throw new Qt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Qt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new ds("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qt("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ds("No code detected.");const{data:x,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:x.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new Qt("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let f=u+h;l&&(f=parseInt(l));const y=f-u;y*1e3<=lt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${h}s`);const p=f-h;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,u);const{data:b,error:m}=await this._getUser(i);if(m)throw m;const v={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(n){if(C(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Zt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(mc(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await er(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Ec(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await ot(this.storage,this.storageKey,!0));try{return await T(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(C(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(C(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:s}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:f}=i;if(f)throw f;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await T(this.fetch,"GET",y,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Se()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(C(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:o}=t;if(o)throw o;return await T(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(C(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await Tc(async s=>(s>0&&await Rc(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await T(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Le})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Fr(i)&&Date.now()+o-n<lt})}catch(n){if(this._debug(t,"error",n),C(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Se()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await Zt(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const s=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Nr;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${Nr}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Fr(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Ie;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Sr;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ie;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),C(i)){const o={session:null,error:i};return Fr(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Li(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await er(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Se()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),lt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/lt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${lt}ms, refresh threshold is ${rn} ticks`),s<=rn&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Di)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Se()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await ot(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await T(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(C(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await T(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(C(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(C(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(C(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(e==null?void 0:e.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=zr(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((n=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(o=>o.kid===e);if(n||(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+fc>Date.now()))return n;const{data:s,error:i}=await T(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Dt("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(o=>o.kid===e),!n)throw new Dt("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:y,error:p}=await this.getSession();if(p||!y.session)return{data:null,error:p};n=y.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=zr(n);if(Dc(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:y}=await this.getUser(n);if(y)throw y;return{data:{claims:i,header:s,signature:o},error:null}}const c=Bc(s.alg),u=await this.fetchJwk(s.kid,t),h=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,o,Sc(`${a}.${l}`)))throw new Dt("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(C(n))return{data:null,error:n};throw n}}}Ut.nextInstanceID=0;const Zc=Ut;class ed extends Zc{constructor(e){super(e)}}var td=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})};class rd{constructor(e,t,n){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=ac(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:Zl,realtime:tc,auth:Object.assign(Object.assign({},ec),{storageKey:l}),global:Ql},u=lc(n??{},c);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=ic(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new wl(`${a}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new ll(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Gl(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return td(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,storageKey:i,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ed({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Ll(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const nd=(r,e,t)=>new rd(r,e,t),sd="https://rjbgomsmplhldxnojkyz.supabase.co",id="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJqYmdvbXNtcGxobGR4bm9qa3l6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ0OTUwOTAsImV4cCI6MjA2MDA3MTA5MH0.FGoxQunc7nWaIwb1F9FdrmFgCSJ3ut34VwVg2w0g4l0",Z=nd(sd,id);var Bi={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},vs=j.createContext&&j.createContext(Bi),od=["attr","size","title"];function ad(r,e){if(r==null)return{};var t=ld(r,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function ld(r,e){if(r==null)return{};var t={};for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(e.indexOf(n)>=0)continue;t[n]=r[n]}return t}function gr(){return gr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},gr.apply(this,arguments)}function ws(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function yr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ws(Object(t),!0).forEach(function(n){cd(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ws(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function cd(r,e,t){return e=dd(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function dd(r){var e=ud(r,"string");return typeof e=="symbol"?e:e+""}function ud(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Ni(r){return r&&r.map((e,t)=>j.createElement(e.tag,yr({key:t},e.attr),Ni(e.child)))}function Cn(r){return e=>j.createElement(hd,gr({attr:yr({},r.attr)},e),Ni(r.child))}function hd(r){var e=t=>{var{attr:n,size:s,title:i}=r,o=ad(r,od),a=s||t.size||"1em",l;return t.className&&(l=t.className),r.className&&(l=(l?l+" ":"")+r.className),j.createElement("svg",gr({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,o,{className:l,style:yr(yr({color:r.color||t.color},t.style),r.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),i&&j.createElement("title",null,i),r.children)};return vs!==void 0?j.createElement(vs.Consumer,null,t=>e(t)):e(Bi)}function fd(r){return Cn({attr:{viewBox:"0 0 488 512"},child:[{tag:"path",attr:{d:"M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"},child:[]}]})(r)}function Rn(r){return Cn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(r)}function Tn(r){return Cn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(r)}function pd(){const{t:r}=W(),[e,t]=g.useState(""),[n,s]=g.useState(""),[i,o]=g.useState(!1),[a,l]=g.useState(""),[c,u]=g.useState(!0),h=be();g.useEffect(()=>{(async()=>{const{data:m}=await Z.auth.getSession();m!=null&&m.session&&(console.log("✅ Sesión detectada, redirigiendo..."),h("/dashboard")),u(!1)})()},[]);const f=async b=>{b.preventDefault(),l("");const{data:m,error:v}=await Z.auth.signInWithPassword({email:e,password:n});if(v){console.error("❌ Error de login:",v.message),l(r("wrong_credentials"));return}if(!m.session){l(r("email_not_confirmed"));return}await p(m.session.user)},y=async()=>{l("");const b=`${window.location.origin}/dashboard`;console.log("🌐 Redirigiendo login con Google a:",b);const{data:m,error:v}=await Z.auth.signInWithOAuth({provider:"google",options:{redirectTo:b}});v?(console.error("❌ Error al iniciar con Google:",v.message),l("Error al conectar con Google.")):console.log("📡 Redirección iniciada con Google:",m)},p=async b=>{const m="http://localhost:8001/initialize_user";console.log("📡 Llamando a:",m);try{const v=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth_user_id:b.id,email:b.email})});if(!v.ok)throw new Error("❌ Error al inicializar usuario");const x=await v.json();console.log("✅ Datos de /initialize_user:",x),localStorage.setItem("client_id",x.client_id),localStorage.setItem("public_client_id",x.public_client_id),localStorage.setItem("user_id",b.id),h("/dashboard")}catch(v){console.error(v),l("Hubo un problema al iniciar sesión. Intenta de nuevo.")}};return c?d.jsx("div",{style:_s,children:d.jsx("p",{style:{color:"#ededed",fontSize:"1.1rem"},children:"Cargando sesión..."})}):d.jsx("div",{style:_s,children:d.jsxs("div",{style:md,children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[d.jsx("img",{src:"/logo-evolvian.svg",alt:"Logo Evolvian",style:{width:"64px",margin:"0 auto 1rem"}}),d.jsx("h1",{style:{fontSize:"1.75rem",fontWeight:"bold"},children:"Evolvian"})]}),d.jsxs("form",{onSubmit:f,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsx("div",{style:Ss,children:d.jsx("input",{type:"email",placeholder:r("email"),value:e,onChange:b=>t(b.target.value),required:!0,style:{...xs,border:"none",flex:1},autoComplete:"email"})}),d.jsxs("div",{style:Ss,children:[d.jsx("input",{type:i?"text":"password",placeholder:r("password"),value:n,onChange:b=>s(b.target.value),required:!0,style:{...xs,border:"none",flex:1},autoComplete:"current-password"}),d.jsx("div",{style:gd,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:i?d.jsx(Rn,{}):d.jsx(Tn,{})})]}),a&&d.jsx("p",{style:{color:"#f87171",textAlign:"center",fontSize:"0.875rem"},children:a}),d.jsx("button",{type:"submit",style:yd,children:r("login")}),d.jsxs("div",{style:bd,children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:[d.jsx("input",{type:"checkbox"}),r("remember_me")]}),d.jsx(Ne,{to:"/forgot-password",style:vd,children:r("forgot_password")})]})]}),d.jsxs("p",{style:wd,children:[r("no_account")||"¿No tienes cuenta?"," ",d.jsx(Ne,{to:"/register",style:_d,children:r("register_here")||"Regístrate aquí"})]}),d.jsxs("div",{style:xd,children:[d.jsx("div",{style:js}),d.jsx("span",{children:r("or")}),d.jsx("div",{style:js})]}),d.jsxs("button",{onClick:y,style:Sd,children:[d.jsx(fd,{}),r("login_with_google")]})]})})}const _s={height:"100vh",width:"100vw",backgroundColor:"#0f1c2e",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",fontFamily:"system-ui, Avenir, Helvetica, Arial, sans-serif"},md={width:"100%",maxWidth:"400px",backgroundColor:"#1b2a41",color:"white",borderRadius:"1.5rem",padding:"2rem",boxShadow:"0 15px 40px rgba(0,0,0,0.3)",border:"1px solid #274472"},xs={width:"100%",padding:"0.6rem 1rem",backgroundColor:"transparent",borderRadius:"8px",color:"white",fontSize:"1rem"},Ss={display:"flex",alignItems:"center",border:"1px solid #274472",borderRadius:"8px",backgroundColor:"transparent",height:"40px",paddingRight:"0.75rem"},gd={color:"#ccc",cursor:"pointer",fontSize:"1.1rem"},yd={backgroundColor:"#2eb39a",padding:"0.7rem",color:"white",borderRadius:"8px",fontWeight:"bold",border:"none",cursor:"pointer",fontSize:"1rem"},bd={display:"flex",justifyContent:"space-between",fontSize:"0.875rem",color:"#ccc",marginTop:"0.5rem"},vd={color:"#a3d9b1",textDecoration:"underline"},wd={textAlign:"center",fontSize:"0.875rem",color:"#bbb",marginTop:"2rem"},_d={color:"#f5a623",fontWeight:"bold",textDecoration:"underline"},xd={display:"flex",alignItems:"center",gap:"1rem",margin:"2rem 0",color:"#888"},js={flex:1,height:"1px",backgroundColor:"#555"},Sd={width:"100%",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",padding:"0.7rem",border:"1px solid white",borderRadius:"8px",backgroundColor:"transparent",color:"white",cursor:"pointer",fontSize:"1rem"};function jd(r){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.appendChild(t),t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}const Ed=r=>{switch(r){case"success":return Rd;case"info":return Pd;case"warning":return Td;case"error":return Ad;default:return null}},kd=Array(12).fill(0),Cd=({visible:r,className:e})=>j.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":r},j.createElement("div",{className:"sonner-spinner"},kd.map((t,n)=>j.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),Rd=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},j.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Td=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},j.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Pd=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},j.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ad=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},j.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Od=j.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},j.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),j.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),$d=()=>{const[r,e]=j.useState(document.hidden);return j.useEffect(()=>{const t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),r};let on=1;class Id{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:n,...s}=e,i=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:on++,o=this.toasts.find(l=>l.id===i),a=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:n}),{...l,...e,id:i,dismissible:a,title:n}):l):this.addToast({title:n,...s,dismissible:a,id:i}),i},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));const s=Promise.resolve(e instanceof Function?e():e);let i=n!==void 0,o;const a=s.then(async c=>{if(o=["resolve",c],j.isValidElement(c))i=!1,this.create({id:n,type:"default",message:c});else if(Dd(c)&&!c.ok){i=!1;const h=typeof t.error=="function"?await t.error(`HTTP error! status: ${c.status}`):t.error,f=typeof t.description=="function"?await t.description(`HTTP error! status: ${c.status}`):t.description,p=typeof h=="object"&&!j.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:f,...p})}else if(c instanceof Error){i=!1;const h=typeof t.error=="function"?await t.error(c):t.error,f=typeof t.description=="function"?await t.description(c):t.description,p=typeof h=="object"&&!j.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:f,...p})}else if(t.success!==void 0){i=!1;const h=typeof t.success=="function"?await t.success(c):t.success,f=typeof t.description=="function"?await t.description(c):t.description,p=typeof h=="object"&&!j.isValidElement(h)?h:{message:h};this.create({id:n,type:"success",description:f,...p})}}).catch(async c=>{if(o=["reject",c],t.error!==void 0){i=!1;const u=typeof t.error=="function"?await t.error(c):t.error,h=typeof t.description=="function"?await t.description(c):t.description,y=typeof u=="object"&&!j.isValidElement(u)?u:{message:u};this.create({id:n,type:"error",description:h,...y})}}).finally(()=>{i&&(this.dismiss(n),n=void 0),t.finally==null||t.finally.call(t)}),l=()=>new Promise((c,u)=>a.then(()=>o[0]==="reject"?u(o[1]):c(o[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:l}:Object.assign(n,{unwrap:l})},this.custom=(e,t)=>{const n=(t==null?void 0:t.id)||on++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const te=new Id,Ld=(r,e)=>{const t=(e==null?void 0:e.id)||on++;return te.addToast({title:r,...e,id:t}),t},Dd=r=>r&&typeof r=="object"&&"ok"in r&&typeof r.ok=="boolean"&&"status"in r&&typeof r.status=="number",Bd=Ld,Nd=()=>te.toasts,Ud=()=>te.getActiveToasts(),X=Object.assign(Bd,{success:te.success,info:te.info,warning:te.warning,error:te.error,custom:te.custom,message:te.message,promise:te.promise,dismiss:te.dismiss,loading:te.loading},{getHistory:Nd,getToasts:Ud});jd("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function tr(r){return r.label!==void 0}const Fd=3,zd="24px",Md="16px",Es=4e3,qd=356,Wd=14,Hd=45,Jd=200;function _e(...r){return r.filter(Boolean).join(" ")}function Vd(r){const[e,t]=r.split("-"),n=[];return e&&n.push(e),t&&n.push(t),n}const Kd=r=>{var e,t,n,s,i,o,a,l,c;const{invert:u,toast:h,unstyled:f,interacting:y,setHeights:p,visibleToasts:b,heights:m,index:v,toasts:x,expanded:w,removeToast:S,defaultRichColors:E,closeButton:P,style:O,cancelButtonStyle:L,actionButtonStyle:D,className:H="",descriptionClassName:le="",duration:Ge,position:bt,gap:Pr,expandByDefault:we,classNames:A,icons:he,closeButtonAriaLabel:ke="Close toast"}=r,[fe,vt]=j.useState(null),[$,M]=j.useState(null),[B,ce]=j.useState(!1),[Fe,q]=j.useState(!1),[wt,Ye]=j.useState(!1),[_t,xt]=j.useState(!1),[ho,$n]=j.useState(!1),[fo,Ar]=j.useState(0),[po,In]=j.useState(0),St=j.useRef(h.duration||Ge||Es),Ln=j.useRef(null),Ce=j.useRef(null),mo=v===0,go=v+1<=b,ne=h.type,Xe=h.dismissible!==!1,yo=h.className||"",bo=h.descriptionClassName||"",Jt=j.useMemo(()=>m.findIndex(R=>R.toastId===h.id)||0,[m,h.id]),vo=j.useMemo(()=>{var R;return(R=h.closeButton)!=null?R:P},[h.closeButton,P]),Dn=j.useMemo(()=>h.duration||Ge||Es,[h.duration,Ge]),Or=j.useRef(0),Qe=j.useRef(0),Bn=j.useRef(0),Ze=j.useRef(null),[wo,_o]=bt.split("-"),Nn=j.useMemo(()=>m.reduce((R,J,Y)=>Y>=Jt?R:R+J.height,0),[m,Jt]),Un=$d(),xo=h.invert||u,$r=ne==="loading";Qe.current=j.useMemo(()=>Jt*Pr+Nn,[Jt,Nn]),j.useEffect(()=>{St.current=Dn},[Dn]),j.useEffect(()=>{ce(!0)},[]),j.useEffect(()=>{const R=Ce.current;if(R){const J=R.getBoundingClientRect().height;return In(J),p(Y=>[{toastId:h.id,height:J,position:h.position},...Y]),()=>p(Y=>Y.filter(se=>se.toastId!==h.id))}},[p,h.id]),j.useLayoutEffect(()=>{if(!B)return;const R=Ce.current,J=R.style.height;R.style.height="auto";const Y=R.getBoundingClientRect().height;R.style.height=J,In(Y),p(se=>se.find(G=>G.toastId===h.id)?se.map(G=>G.toastId===h.id?{...G,height:Y}:G):[{toastId:h.id,height:Y,position:h.position},...se])},[B,h.title,h.description,p,h.id]);const $e=j.useCallback(()=>{q(!0),Ar(Qe.current),p(R=>R.filter(J=>J.toastId!==h.id)),setTimeout(()=>{S(h)},Jd)},[h,S,p,Qe]);j.useEffect(()=>{if(h.promise&&ne==="loading"||h.duration===1/0||h.type==="loading")return;let R;return w||y||Un?(()=>{if(Bn.current<Or.current){const se=new Date().getTime()-Or.current;St.current=St.current-se}Bn.current=new Date().getTime()})():(()=>{St.current!==1/0&&(Or.current=new Date().getTime(),R=setTimeout(()=>{h.onAutoClose==null||h.onAutoClose.call(h,h),$e()},St.current))})(),()=>clearTimeout(R)},[w,y,h,ne,Un,$e]),j.useEffect(()=>{h.delete&&$e()},[$e,h.delete]);function So(){var R;if(he!=null&&he.loading){var J;return j.createElement("div",{className:_e(A==null?void 0:A.loader,h==null||(J=h.classNames)==null?void 0:J.loader,"sonner-loader"),"data-visible":ne==="loading"},he.loading)}return j.createElement(Cd,{className:_e(A==null?void 0:A.loader,h==null||(R=h.classNames)==null?void 0:R.loader),visible:ne==="loading"})}const jo=h.icon||(he==null?void 0:he[ne])||Ed(ne);var Fn,zn;return j.createElement("li",{tabIndex:0,ref:Ce,className:_e(H,yo,A==null?void 0:A.toast,h==null||(e=h.classNames)==null?void 0:e.toast,A==null?void 0:A.default,A==null?void 0:A[ne],h==null||(t=h.classNames)==null?void 0:t[ne]),"data-sonner-toast":"","data-rich-colors":(Fn=h.richColors)!=null?Fn:E,"data-styled":!(h.jsx||h.unstyled||f),"data-mounted":B,"data-promise":!!h.promise,"data-swiped":ho,"data-removed":Fe,"data-visible":go,"data-y-position":wo,"data-x-position":_o,"data-index":v,"data-front":mo,"data-swiping":wt,"data-dismissible":Xe,"data-type":ne,"data-invert":xo,"data-swipe-out":_t,"data-swipe-direction":$,"data-expanded":!!(w||we&&B),style:{"--index":v,"--toasts-before":v,"--z-index":x.length-v,"--offset":`${Fe?fo:Qe.current}px`,"--initial-height":we?"auto":`${po}px`,...O,...h.style},onDragEnd:()=>{Ye(!1),vt(null),Ze.current=null},onPointerDown:R=>{$r||!Xe||(Ln.current=new Date,Ar(Qe.current),R.target.setPointerCapture(R.pointerId),R.target.tagName!=="BUTTON"&&(Ye(!0),Ze.current={x:R.clientX,y:R.clientY}))},onPointerUp:()=>{var R,J,Y;if(_t||!Xe)return;Ze.current=null;const se=Number(((R=Ce.current)==null?void 0:R.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Vt=Number(((J=Ce.current)==null?void 0:J.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),G=new Date().getTime()-((Y=Ln.current)==null?void 0:Y.getTime()),de=fe==="x"?se:Vt,Kt=Math.abs(de)/G;if(Math.abs(de)>=Hd||Kt>.11){Ar(Qe.current),h.onDismiss==null||h.onDismiss.call(h,h),M(fe==="x"?se>0?"right":"left":Vt>0?"down":"up"),$e(),xt(!0);return}else{var pe,me;(pe=Ce.current)==null||pe.style.setProperty("--swipe-amount-x","0px"),(me=Ce.current)==null||me.style.setProperty("--swipe-amount-y","0px")}$n(!1),Ye(!1),vt(null)},onPointerMove:R=>{var J,Y,se;if(!Ze.current||!Xe||((J=window.getSelection())==null?void 0:J.toString().length)>0)return;const G=R.clientY-Ze.current.y,de=R.clientX-Ze.current.x;var Kt;const pe=(Kt=r.swipeDirections)!=null?Kt:Vd(bt);!fe&&(Math.abs(de)>1||Math.abs(G)>1)&&vt(Math.abs(de)>Math.abs(G)?"x":"y");let me={x:0,y:0};const Mn=ze=>1/(1.5+Math.abs(ze)/20);if(fe==="y"){if(pe.includes("top")||pe.includes("bottom"))if(pe.includes("top")&&G<0||pe.includes("bottom")&&G>0)me.y=G;else{const ze=G*Mn(G);me.y=Math.abs(ze)<Math.abs(G)?ze:G}}else if(fe==="x"&&(pe.includes("left")||pe.includes("right")))if(pe.includes("left")&&de<0||pe.includes("right")&&de>0)me.x=de;else{const ze=de*Mn(de);me.x=Math.abs(ze)<Math.abs(de)?ze:de}(Math.abs(me.x)>0||Math.abs(me.y)>0)&&$n(!0),(Y=Ce.current)==null||Y.style.setProperty("--swipe-amount-x",`${me.x}px`),(se=Ce.current)==null||se.style.setProperty("--swipe-amount-y",`${me.y}px`)}},vo&&!h.jsx&&ne!=="loading"?j.createElement("button",{"aria-label":ke,"data-disabled":$r,"data-close-button":!0,onClick:$r||!Xe?()=>{}:()=>{$e(),h.onDismiss==null||h.onDismiss.call(h,h)},className:_e(A==null?void 0:A.closeButton,h==null||(n=h.classNames)==null?void 0:n.closeButton)},(zn=he==null?void 0:he.close)!=null?zn:Od):null,(ne||h.icon||h.promise)&&h.icon!==null&&((he==null?void 0:he[ne])!==null||h.icon)?j.createElement("div",{"data-icon":"",className:_e(A==null?void 0:A.icon,h==null||(s=h.classNames)==null?void 0:s.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||So():null,h.type!=="loading"?jo:null):null,j.createElement("div",{"data-content":"",className:_e(A==null?void 0:A.content,h==null||(i=h.classNames)==null?void 0:i.content)},j.createElement("div",{"data-title":"",className:_e(A==null?void 0:A.title,h==null||(o=h.classNames)==null?void 0:o.title)},h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title),h.description?j.createElement("div",{"data-description":"",className:_e(le,bo,A==null?void 0:A.description,h==null||(a=h.classNames)==null?void 0:a.description)},typeof h.description=="function"?h.description():h.description):null),j.isValidElement(h.cancel)?h.cancel:h.cancel&&tr(h.cancel)?j.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||L,onClick:R=>{tr(h.cancel)&&Xe&&(h.cancel.onClick==null||h.cancel.onClick.call(h.cancel,R),$e())},className:_e(A==null?void 0:A.cancelButton,h==null||(l=h.classNames)==null?void 0:l.cancelButton)},h.cancel.label):null,j.isValidElement(h.action)?h.action:h.action&&tr(h.action)?j.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||D,onClick:R=>{tr(h.action)&&(h.action.onClick==null||h.action.onClick.call(h.action,R),!R.defaultPrevented&&$e())},className:_e(A==null?void 0:A.actionButton,h==null||(c=h.classNames)==null?void 0:c.actionButton)},h.action.label):null)};function ks(){if(typeof window>"u"||typeof document>"u")return"ltr";const r=document.documentElement.getAttribute("dir");return r==="auto"||!r?window.getComputedStyle(document.documentElement).direction:r}function Gd(r,e){const t={};return[r,e].forEach((n,s)=>{const i=s===1,o=i?"--mobile-offset":"--offset",a=i?Md:zd;function l(c){["top","right","bottom","left"].forEach(u=>{t[`${o}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof n=="number"||typeof n=="string"?l(n):typeof n=="object"?["top","right","bottom","left"].forEach(c=>{n[c]===void 0?t[`${o}-${c}`]=a:t[`${o}-${c}`]=typeof n[c]=="number"?`${n[c]}px`:n[c]}):l(a)}),t}const Yd=j.forwardRef(function(e,t){const{invert:n,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:o,closeButton:a,className:l,offset:c,mobileOffset:u,theme:h="light",richColors:f,duration:y,style:p,visibleToasts:b=Fd,toastOptions:m,dir:v=ks(),gap:x=Wd,icons:w,containerAriaLabel:S="Notifications"}=e,[E,P]=j.useState([]),O=j.useMemo(()=>Array.from(new Set([s].concat(E.filter($=>$.position).map($=>$.position)))),[E,s]),[L,D]=j.useState([]),[H,le]=j.useState(!1),[Ge,bt]=j.useState(!1),[Pr,we]=j.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),A=j.useRef(null),he=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),ke=j.useRef(null),fe=j.useRef(!1),vt=j.useCallback($=>{P(M=>{var B;return(B=M.find(ce=>ce.id===$.id))!=null&&B.delete||te.dismiss($.id),M.filter(({id:ce})=>ce!==$.id)})},[]);return j.useEffect(()=>te.subscribe($=>{if($.dismiss){requestAnimationFrame(()=>{P(M=>M.map(B=>B.id===$.id?{...B,delete:!0}:B))});return}setTimeout(()=>{el.flushSync(()=>{P(M=>{const B=M.findIndex(ce=>ce.id===$.id);return B!==-1?[...M.slice(0,B),{...M[B],...$},...M.slice(B+1)]:[$,...M]})})})}),[E]),j.useEffect(()=>{if(h!=="system"){we(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?we("dark"):we("light")),typeof window>"u")return;const $=window.matchMedia("(prefers-color-scheme: dark)");try{$.addEventListener("change",({matches:M})=>{we(M?"dark":"light")})}catch{$.addListener(({matches:B})=>{try{we(B?"dark":"light")}catch(ce){console.error(ce)}})}},[h]),j.useEffect(()=>{E.length<=1&&le(!1)},[E]),j.useEffect(()=>{const $=M=>{var B;if(i.every(q=>M[q]||M.code===q)){var Fe;le(!0),(Fe=A.current)==null||Fe.focus()}M.code==="Escape"&&(document.activeElement===A.current||(B=A.current)!=null&&B.contains(document.activeElement))&&le(!1)};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[i]),j.useEffect(()=>{if(A.current)return()=>{ke.current&&(ke.current.focus({preventScroll:!0}),ke.current=null,fe.current=!1)}},[A.current]),j.createElement("section",{ref:t,"aria-label":`${S} ${he}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},O.map(($,M)=>{var B;const[ce,Fe]=$.split("-");return E.length?j.createElement("ol",{key:$,dir:v==="auto"?ks():v,tabIndex:-1,ref:A,className:l,"data-sonner-toaster":!0,"data-sonner-theme":Pr,"data-y-position":ce,"data-lifted":H&&E.length>1&&!o,"data-x-position":Fe,style:{"--front-toast-height":`${((B=L[0])==null?void 0:B.height)||0}px`,"--width":`${qd}px`,"--gap":`${x}px`,...p,...Gd(c,u)},onBlur:q=>{fe.current&&!q.currentTarget.contains(q.relatedTarget)&&(fe.current=!1,ke.current&&(ke.current.focus({preventScroll:!0}),ke.current=null))},onFocus:q=>{q.target instanceof HTMLElement&&q.target.dataset.dismissible==="false"||fe.current||(fe.current=!0,ke.current=q.relatedTarget)},onMouseEnter:()=>le(!0),onMouseMove:()=>le(!0),onMouseLeave:()=>{Ge||le(!1)},onDragEnd:()=>le(!1),onPointerDown:q=>{q.target instanceof HTMLElement&&q.target.dataset.dismissible==="false"||bt(!0)},onPointerUp:()=>bt(!1)},E.filter(q=>!q.position&&M===0||q.position===$).map((q,wt)=>{var Ye,_t;return j.createElement(Kd,{key:q.id,icons:w,index:wt,toast:q,defaultRichColors:f,duration:(Ye=m==null?void 0:m.duration)!=null?Ye:y,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:n,visibleToasts:b,closeButton:(_t=m==null?void 0:m.closeButton)!=null?_t:a,interacting:Ge,position:$,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,closeButtonAriaLabel:m==null?void 0:m.closeButtonAriaLabel,removeToast:vt,toasts:E.filter(xt=>xt.position==q.position),heights:L.filter(xt=>xt.position==q.position),setHeights:D,expandByDefault:o,gap:x,expanded:H,swipeDirections:e.swipeDirections})})):null}))});function Xd(){const{t:r}=W(),[e,t]=g.useState(""),[n,s]=g.useState(""),[i,o]=g.useState(""),[a,l]=g.useState(!1),c=be(),u=async h=>{if(h.preventDefault(),n!==i){X.error(r("passwords_do_not_match")||"Las contraseñas no coinciden");return}if(!/^[A-Za-z0-9]{8,}$/.test(n)){X.error(`${r("invalid_password_format")} ${r("password_hint")}`);return}try{const p=await(await fetch("http://localhost:8001/check_email_exists",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})})).json();if(p.exists){X.error(`${r("email_already_registered")} ${p.provider}`);return}const{data:b,error:m}=await Z.auth.signUp({email:e,password:n});if(m){X.error(r("error_creating_account")+": "+m.message);return}if(!b.session){X.success(r("account_created_check_email")),setTimeout(()=>c("/login"),3e3);return}if(!(await fetch("http://localhost:8001/initialize_user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth_user_id:b.user.id,email:b.user.email})})).ok){X.error(r("error_initializing_account"));return}X.success(r("account_created_redirecting")),setTimeout(()=>c("/dashboard"),2e3)}catch(y){console.error(y),X.error(r("unexpected_error"))}};return d.jsx("div",{style:Qd,children:d.jsxs("div",{style:Zd,children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[d.jsx("img",{src:"/logo-evolvian.svg",alt:"Logo Evolvian",style:{width:"64px",margin:"0 auto 1rem"}}),d.jsx("h1",{style:{fontSize:"1.75rem",fontWeight:"bold"},children:r("create_account")})]}),d.jsxs("form",{onSubmit:u,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsx("div",{style:qr,children:d.jsx("input",{type:"email",placeholder:r("email"),value:e,onChange:h=>t(h.target.value),required:!0,style:{...Mr,border:"none",flex:1}})}),d.jsxs("div",{style:qr,children:[d.jsx("input",{type:a?"text":"password",placeholder:r("password"),value:n,onChange:h=>s(h.target.value),required:!0,style:{...Mr,border:"none",flex:1}}),d.jsx("div",{style:eu,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:a?d.jsx(Rn,{}):d.jsx(Tn,{})})]}),d.jsx("p",{style:tu,children:r("password_hint")}),d.jsx("div",{style:qr,children:d.jsx("input",{type:"password",placeholder:r("confirm_password")||"Confirmar contraseña",value:i,onChange:h=>o(h.target.value),required:!0,style:{...Mr,border:"none",flex:1}})}),d.jsx("button",{type:"submit",style:ru,children:r("create_account")})]}),d.jsxs("p",{style:nu,children:[r("already_have_account")," ",d.jsx(Ne,{to:"/login",style:su,children:r("login_here")})]})]})})}const Qd={height:"100vh",width:"100vw",backgroundColor:"#0f1c2e",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",fontFamily:"system-ui, Avenir, Helvetica, Arial, sans-serif"},Zd={width:"100%",maxWidth:"400px",backgroundColor:"#1b2a41",color:"white",borderRadius:"1.5rem",padding:"2rem",boxShadow:"0 15px 40px rgba(0,0,0,0.3)",border:"1px solid #274472"},Mr={width:"100%",padding:"0.6rem 1rem",background:"transparent",borderRadius:"8px",color:"white",fontSize:"1rem"},qr={display:"flex",alignItems:"center",border:"1px solid #274472",borderRadius:"8px",backgroundColor:"transparent",height:"40px",paddingRight:"0.75rem"},eu={color:"#ccc",cursor:"pointer",fontSize:"1.1rem"},tu={fontSize:"0.75rem",color:"#ccc",marginTop:"-0.5rem",marginBottom:"0.5rem",paddingLeft:"0.25rem"},ru={backgroundColor:"#2eb39a",padding:"0.7rem",color:"white",borderRadius:"8px",fontWeight:"bold",border:"none",cursor:"pointer",fontSize:"1rem"},nu={textAlign:"center",fontSize:"0.875rem",color:"#bbb",marginTop:"2rem"},su={color:"#f5a623",fontWeight:"bold",textDecoration:"underline"};function iu(){const{t:r}=W(),e=be();return g.useEffect(()=>{const t=setTimeout(()=>{e("/login")},4e3);return()=>clearTimeout(t)},[e]),d.jsx("div",{style:ou,children:d.jsxs("div",{style:au,children:[d.jsxs("h2",{style:lu,children:["✅ ",r("email_confirmed_successfully")]}),d.jsx("p",{style:cu,children:r("redirecting_to_login")})]})})}const ou={height:"100vh",width:"100vw",backgroundColor:"#0f1c2e",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",fontFamily:"system-ui, Avenir, Helvetica, Arial, sans-serif"},au={backgroundColor:"#1b2a41",color:"#ffffff",padding:"2rem",borderRadius:"1.5rem",boxShadow:"0 15px 40px rgba(0,0,0,0.3)",textAlign:"center",maxWidth:"400px",width:"100%",border:"1px solid #274472"},lu={fontSize:"1.25rem",fontWeight:"600",marginBottom:"0.75rem",color:"#a3d9b1"},cu={fontSize:"0.95rem",color:"#ededed"};function du(){const{t:r}=W(),[e,t]=g.useState(""),n=async s=>{s.preventDefault();const{error:i}=await Z.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/reset-password`});i?(console.error("❌ Error al enviar reset:",i.message),X.error(r("error_sending_reset_email"))):X.success(r("check_your_email"))};return d.jsx("div",{style:uu,children:d.jsxs("div",{style:hu,children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[d.jsx("img",{src:"/logo-evolvian.svg",alt:"Logo Evolvian",style:{width:"64px",margin:"0 auto 1rem"}}),d.jsx("h1",{style:fu,children:r("recover_password")}),d.jsx("p",{style:pu,children:r("enter_your_email")})]}),d.jsxs("form",{onSubmit:n,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsx("div",{style:mu,children:d.jsx("input",{type:"email",placeholder:r("email"),value:e,onChange:s=>t(s.target.value),required:!0,style:{...gu,border:"none",flex:1}})}),d.jsx("button",{type:"submit",style:yu,children:r("send_email")})]}),d.jsxs("p",{style:bu,children:[r("already_have_access")," ",d.jsx(Ne,{to:"/login",style:vu,children:r("login")})]})]})})}const uu={height:"100vh",width:"100vw",backgroundColor:"#0f1c2e",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",fontFamily:"system-ui, Avenir, Helvetica, Arial, sans-serif"},hu={width:"100%",maxWidth:"400px",backgroundColor:"#1b2a41",borderRadius:"1.5rem",padding:"2rem",color:"white",boxShadow:"0 15px 40px rgba(0,0,0,0.3)",border:"1px solid #274472"},fu={fontSize:"1.5rem",fontWeight:"bold"},pu={fontSize:"0.9rem",color:"#ccc"},mu={display:"flex",alignItems:"center",border:"1px solid #274472",borderRadius:"8px",backgroundColor:"transparent",height:"40px",paddingRight:"0.75rem"},gu={width:"100%",padding:"0.6rem 1rem",background:"transparent",borderRadius:"8px",color:"white",fontSize:"1rem"},yu={backgroundColor:"#2eb39a",padding:"0.7rem",color:"white",borderRadius:"8px",fontWeight:"bold",border:"none",cursor:"pointer",fontSize:"1rem"},bu={textAlign:"center",fontSize:"0.875rem",color:"#bbb",marginTop:"2rem"},vu={color:"#f5a623",fontWeight:"bold",textDecoration:"underline"};function wu(){const{t:r}=W(),e=be(),[t,n]=g.useState(""),[s,i]=g.useState(!1),[o,a]=g.useState(!1),[l,c]=g.useState(!1);g.useEffect(()=>{window.location.hash.includes("access_token")?c(!0):(X.error(r("invalid_token")),e("/forgot-password"))},[e,r]);const u=async h=>{h.preventDefault(),a(!0);const{error:f}=await Z.auth.updateUser({password:t});f?X.error(`❌ ${r("error_updating_password")}: ${f.message}`):(X.success(`🔒 ${r("password_updated_successfully")}`),e("/login")),a(!1)};return l?d.jsx("div",{style:_u,children:d.jsxs("div",{style:xu,children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"1.5rem"},children:[d.jsx("img",{src:"/logo-evolvian.svg",alt:"Logo Evolvian",style:{width:"64px",margin:"0 auto 1rem"}}),d.jsx("h1",{style:Su,children:r("new_password")}),d.jsx("p",{style:ju,children:r("enter_new_password")})]}),d.jsxs("form",{onSubmit:u,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsxs("div",{style:Eu,children:[d.jsx("input",{type:s?"text":"password",placeholder:r("new_password_placeholder"),value:t,onChange:h=>n(h.target.value),required:!0,style:{...ku,border:"none",flex:1}}),d.jsx("div",{style:Cu,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:s?d.jsx(Rn,{}):d.jsx(Tn,{})})]}),d.jsx("button",{type:"submit",disabled:o,style:{...Ru,opacity:o?.7:1,cursor:o?"not-allowed":"pointer"},children:r(o?"updating":"update_password")})]})]})}):null}const _u={height:"100vh",width:"100vw",backgroundColor:"#0f1c2e",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",fontFamily:"system-ui, Avenir, Helvetica, Arial, sans-serif"},xu={width:"100%",maxWidth:"400px",backgroundColor:"#1b2a41",borderRadius:"1.5rem",padding:"2rem",color:"white",boxShadow:"0 15px 40px rgba(0,0,0,0.3)",border:"1px solid #274472"},Su={fontSize:"1.5rem",fontWeight:"bold"},ju={fontSize:"0.9rem",color:"#ccc"},Eu={display:"flex",alignItems:"center",border:"1px solid #274472",borderRadius:"8px",backgroundColor:"transparent",height:"40px",paddingRight:"0.75rem"},ku={width:"100%",padding:"0.6rem 1rem",background:"transparent",borderRadius:"8px",color:"white",fontSize:"1rem"},Cu={color:"#ccc",cursor:"pointer",fontSize:"1.1rem"},Ru={backgroundColor:"#2eb39a",padding:"0.7rem",color:"white",borderRadius:"8px",fontWeight:"bold",border:"none",fontSize:"1rem"};function Tu(){const{t:r}=W(),[e,t]=g.useState(""),[n,s]=g.useState(!1),[i,o]=g.useState(!1),a=async l=>{l.preventDefault(),s(!0);const{error:c}=await Z.auth.signInWithOtp({email:e,options:{redirectTo:`${window.location.origin}/dashboard`}});c?X.error(r("error_sending_login_link")):(X.success(r("check_your_email_login_link")),o(!0)),s(!1)};return d.jsx("div",{style:Pu,children:d.jsxs("div",{style:Au,children:[d.jsxs("div",{style:{textAlign:"center",marginBottom:"1.5rem"},children:[d.jsx("img",{src:"/logo-evolvian.svg",alt:"Logo Evolvian",style:{width:"64px",margin:"0 auto 1rem"}}),d.jsx("h1",{style:Ou,children:r("access_verification")}),d.jsx("p",{style:$u,children:r("confirm_email_to_continue")})]}),i?d.jsx("p",{style:{textAlign:"center",color:"#ededed"},children:r("email_link_sent")}):d.jsxs("form",{onSubmit:a,style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsx("input",{type:"email",placeholder:r("email"),value:e,onChange:l=>t(l.target.value),required:!0,style:Iu}),d.jsx("button",{type:"submit",disabled:n,style:{...Lu,opacity:n?.7:1,cursor:n?"not-allowed":"pointer"},children:r(n?"sending":"send_login_link")})]})]})})}const Pu={height:"100vh",width:"100vw",backgroundColor:"#0f1c2e",display:"flex",alignItems:"center",justifyContent:"center",padding:"1rem",fontFamily:"system-ui, Avenir, Helvetica, Arial, sans-serif"},Au={width:"100%",maxWidth:"400px",backgroundColor:"#1b2a41",borderRadius:"1.5rem",padding:"2rem",color:"white",boxShadow:"0 15px 40px rgba(0,0,0,0.3)",border:"1px solid #274472"},Ou={fontSize:"1.5rem",fontWeight:"bold"},$u={fontSize:"0.9rem",color:"#ccc"},Iu={padding:"0.6rem 1rem",background:"transparent",border:"1px solid #274472",borderRadius:"8px",color:"white",fontSize:"1rem"},Lu={backgroundColor:"#2eb39a",padding:"0.7rem",color:"white",borderRadius:"8px",fontWeight:"bold",border:"none",fontSize:"1rem"};function Du(r){const[e,t]=g.useState(null);return g.useEffect(()=>{if(!r)return;(async()=>{try{const o=await(await fetch(`http://localhost:8001/accepted_terms?client_id=${r}`)).json();t(o.has_accepted)}catch(i){console.error("❌ Error al verificar aceptación de términos:",i),t(!1)}})()},[r]),{hasAccepted:e,acceptTerms:async()=>{try{if(!(await fetch("http://localhost:8001/accept_terms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:r})})).ok)throw new Error("Error al registrar aceptación");t(!0)}catch(s){console.error("❌ Error al aceptar términos:",s)}}}}function Ee(){const[r,e]=g.useState(()=>{const t=localStorage.getItem("client_id");return t&&t!=="undefined"&&t!=="null"?t:null});return g.useEffect(()=>{const t=n=>{if(n.key==="client_id"){const s=n.newValue;s&&s!=="undefined"&&s!=="null"&&e(s)}};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[]),r}function Bu(){const r=be(),[e,t]=g.useState(!1),n=Ee(),{hasAccepted:s,acceptTerms:i}=Du(n),o=async()=>{t(!0);const a=localStorage.getItem("user_id");console.log("🧠 Obtenido user_id desde localStorage:",a);try{if(a){const c=await(await fetch(`http://localhost:8001/clear_new_user_flag?user_id=${a}`,{method:"POST"})).json();console.log("✅ Respuesta de clear_new_user_flag:",c),console.log("🔄 Refrescando sesión después de limpiar bandera..."),await Z.auth.refreshSession(),sessionStorage.removeItem("alreadyRedirected")}else console.warn("⚠️ user_id no está disponible en localStorage");!s&&n&&(console.log("📩 Aceptando términos con client_id:",n),await i()),console.log("➡️ Redirigiendo a /dashboard..."),r("/dashboard",{replace:!0})}catch(l){console.error("❌ Error en Welcome:",l),r("/dashboard",{replace:!0})}finally{t(!1)}};return s===null?d.jsx("div",{style:{color:"white",padding:"2rem"},children:"Cargando..."}):d.jsx("div",{style:{height:"100vh",backgroundColor:"#0f1c2e",display:"flex",alignItems:"center",justifyContent:"center",fontFamily:"system-ui, sans-serif",padding:"2rem",color:"white"},children:d.jsxs("div",{style:{backgroundColor:"#1b2a41",padding:"3rem",borderRadius:"1.5rem",maxWidth:"600px",width:"100%",textAlign:"center",boxShadow:"0 0 30px rgba(0,0,0,0.2)",border:"1px solid #274472"},children:[d.jsx("img",{src:"/logo-evolvian.svg",alt:"Evolvian",style:{width:"60px",marginBottom:"1.5rem"}}),d.jsx("h1",{style:{fontSize:"1.8rem",color:"#a3d9b1",marginBottom:"1rem"},children:"Bienvenido a Evolvian, tu nuevo copiloto de conocimiento."}),d.jsxs("p",{style:{fontSize:"1rem",color:"#ededed",marginBottom:"1.5rem"},children:["Has dado el primer paso hacia una forma más rápida, segura y precisa de resolver tus dudas, compartir respuestas y empoderar a tus usuarios.",d.jsx("br",{}),d.jsx("br",{}),"Evolvian es un asistente de inteligencia artificial que entiende tus documentos y responde como si fueras tú. Aquí empieza todo."]}),d.jsx("button",{onClick:o,disabled:e,style:{backgroundColor:"#2eb39a",color:"white",fontSize:"1rem",padding:"0.8rem 1.6rem",border:"none",borderRadius:"8px",fontWeight:"bold",cursor:e?"not-allowed":"pointer"},children:e?"Cargando...":"Ir al panel"})]})})}function Nu(){return d.jsxs("div",{style:{padding:"2rem"},children:[d.jsx("h2",{children:"404 – Página no encontrada"}),d.jsx("p",{children:"La ruta que intentaste no existe."})]})}function Uu(){const[r]=yi(),e=r.get("public_client_id");return e?d.jsx("div",{style:{margin:0,padding:0,width:"100vw",height:"100vh",backgroundColor:"#ededed",fontFamily:"system-ui, sans-serif",display:"flex",justifyContent:"center",alignItems:"center"},children:d.jsxs("div",{style:{width:"360px",height:"520px",backgroundColor:"#ffffff",border:"2px solid #4a90e2",borderRadius:"16px",boxShadow:"0 6px 24px rgba(0,0,0,0.15)",overflow:"hidden"},children:[d.jsx(wr,{clientId:e})," "]})}):d.jsx("div",{style:{padding:"2rem",fontFamily:"system-ui, sans-serif",color:"#e74c3c",textAlign:"center"},children:"⚠️ No se proporcionó un public_client_id."})}function Fu(){const[r,e]=g.useState("");return g.useEffect(()=>{const t=new URLSearchParams(window.location.search),n=t.get("client_id")||t.get("public_client_id");n&&e(n)},[]),r?d.jsx("div",{style:{width:"100%",height:"100%",backgroundColor:"#ffffff"},children:d.jsx(wr,{clientId:r})}):d.jsx("p",{style:{padding:"1rem"},children:"❌ Client ID no encontrado."})}const zu=["Afganistán","Albania","Alemania","Andorra","Angola","Arabia Saudita","Argelia","Argentina","Armenia","Australia","Austria","Azerbaiyán","Bahamas","Bangladesh","Baréin","Bélgica","Belice","Benín","Bielorrusia","Bolivia","Bosnia y Herzegovina","Botsuana","Brasil","Brunéi","Bulgaria","Burkina Faso","Burundi","Cabo Verde","Camboya","Camerún","Canadá","Chile","China","Chipre","Colombia","Comoras","Corea del Sur","Costa de Marfil","Costa Rica","Croacia","Dinamarca","Djibouti","Dominica","Ecuador","Egipto","El Salvador","Emiratos Árabes Unidos","Eslovaquia","Eslovenia","España","Estados Unidos","Estonia","Etiopía","Filipinas","Finlandia","Francia","Gabón","Gambia","Georgia","Ghana","Grecia","Guatemala","Guyana","Honduras","Hungría","India","Indonesia","Irak","Irán","Irlanda","Islandia","Islas Marshall","Israel","Italia","Jamaica","Japón","Jordania","Kazajistán","Kenia","Kirguistán","Kuwait","Laos","Letonia","Líbano","Liberia","Libia","Liechtenstein","Lituania","Luxemburgo","Macedonia del Norte","Madagascar","Malasia","Malaui","Maldivas","Malí","Malta","Marruecos","Mauricio","Mauritania","México","Moldavia","Mónaco","Mongolia","Montenegro","Mozambique","Namibia","Nepal","Nicaragua","Níger","Nigeria","Noruega","Nueva Zelanda","Omán","Países Bajos","Pakistán","Panamá","Papúa Nueva Guinea","Paraguay","Perú","Polonia","Portugal","Qatar","Reino Unido","República Centroafricana","República Checa","República Democrática del Congo","República Dominicana","Ruanda","Rumanía","Rusia","Samoa","San Marino","Santa Lucía","Senegal","Serbia","Seychelles","Singapur","Siria","Somalia","Sri Lanka","Sudáfrica","Sudán","Suecia","Suiza","Surinam","Tailandia","Tanzania","Tayikistán","Timor Oriental","Togo","Tonga","Trinidad y Tobago","Túnez","Turquía","Turkmenistán","Ucrania","Uganda","Uruguay","Uzbekistán","Vanuatu","Vaticano","Venezuela","Vietnam","Yemen","Zambia","Zimbabue"],Mu=["Software","Educación","Salud","Finanzas","Retail","Manufactura","Consultoría","Otro"],qu=["Fundador/CEO","CMO / Marketing Manager","Customer Support","Operations Manager","Sales Executive","IT Manager","Product Manager","Developer / Engineer","HR / People","Otro"],Wu=["Chat Widget","WhatsApp","Email","Otros"],Hu=["1-10 empleados","11-50 empleados","51-200 empleados","201-500 empleados","501-1000 empleados","Más de 1000 empleados"],Rt=["welcome_intro","personalization","terms","plan"];function Ju({onClose:r}){const{t:e}=W(),[t,n]=g.useState(1),[s,i]=g.useState(!1),[o,a]=g.useState({industry:"",role:"",country:"",channels:[],companySize:""}),[l,c]=g.useState(null),[u,h]=g.useState(null);g.useEffect(()=>{async function x(){try{const w=localStorage.getItem("client_id");if(!w)throw new Error("client_id no encontrado en localStorage");const S=await fetch(`http://localhost:8001/client_settings?client_id=${w}`);if(!S.ok)throw new Error(`HTTP ${S.status}: ${await S.text()}`);const E=await S.json();c(E)}catch(w){console.error("❌ Error cargando configuración:",w)}}x()},[]);const f=async()=>{try{i(!0),sessionStorage.setItem("alreadyRedirected","true"),r()}catch(x){console.error("❌ Error en handleContinue:",x)}finally{i(!1)}},y=async()=>{if(h(null),t===3)try{const x=localStorage.getItem("client_id");if(!x)throw new Error("No se encontró client_id");console.log("📝 Guardando perfil del cliente...");const w=await fetch("http://localhost:8001/save_client_profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:x,industry:o.industry,role:o.role,country:o.country,channels:o.channels,company_size:o.companySize})}),S=await w.text();if(console.log("📦 Respuesta perfil:",w.status,S),!w.ok)throw new Error("Error al guardar el perfil del cliente");console.log("✅ Perfil guardado. Ahora aceptando términos...");const E=await fetch("http://localhost:8001/accept_terms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:x})}),P=await E.text();if(console.log("📦 Respuesta términos:",E.status,P),!E.ok)throw new Error("Error al aceptar los términos y condiciones");console.log("✅ Consentimiento completo. Avanzando al paso final..."),n(O=>{const L=Math.min(O+1,Rt.length);return console.log("➡️ Paso actualizado a:",L),L})}catch(x){console.error("❌ Error en paso 3:",x),h("Hubo un problema guardando tu consentimiento. Por favor, intenta de nuevo.")}else n(x=>Math.min(x+1,Rt.length))},p=()=>n(x=>Math.max(x-1,1)),b=x=>{const{name:w,value:S}=x.target;a(E=>({...E,[w]:S}))},m=x=>{a(w=>{const E=w.channels.includes(x)?w.channels.filter(P=>P!==x):[...w.channels,x];return{...w,channels:E}})},v=()=>{var x;switch(t){case 1:return d.jsxs(d.Fragment,{children:[d.jsx("img",{src:"/logo-evolvian.svg",alt:"Evolvian Logo",style:{width:"60px",marginBottom:"1.5rem"}}),d.jsx("h1",{style:rr,children:e("welcome_title")}),d.jsx("p",{style:Tt,children:e("welcome_description")})]});case 2:return d.jsxs(d.Fragment,{children:[d.jsx("h2",{style:rr,children:e("personalization_title")}),d.jsx("p",{style:Tt,children:e("personalization_description")}),d.jsxs("div",{style:Gu,children:[d.jsxs("select",{name:"industry",value:o.industry,onChange:b,style:nr,children:[d.jsx("option",{value:"",children:e("select_industry")}),Mu.map(w=>d.jsx("option",{value:w,children:w},w))]}),d.jsxs("select",{name:"role",value:o.role,onChange:b,style:nr,children:[d.jsx("option",{value:"",children:e("select_role")}),qu.map(w=>d.jsx("option",{value:w,children:w},w))]}),d.jsxs("select",{name:"country",value:o.country,onChange:b,style:nr,children:[d.jsx("option",{value:"",children:e("select_country")}),zu.map(w=>d.jsx("option",{value:w,children:w},w))]}),d.jsxs("div",{style:{textAlign:"left",marginTop:"1rem"},children:[d.jsx("p",{style:{...Tt,marginBottom:"0.5rem"},children:e("interested_channels")}),Wu.map(w=>d.jsxs("label",{style:{color:"#ededed",fontSize:"0.9rem",display:"block",marginBottom:"0.3rem"},children:[d.jsx("input",{type:"checkbox",checked:o.channels.includes(w),onChange:()=>m(w),style:{marginRight:"0.5rem"}}),w]},w))]}),d.jsxs("select",{name:"companySize",value:o.companySize,onChange:b,style:nr,children:[d.jsx("option",{value:"",children:e("select_company_size")}),Hu.map(w=>d.jsx("option",{value:w,children:w},w))]})]})]});case 3:return d.jsxs(d.Fragment,{children:[d.jsx("h2",{style:rr,children:e("terms_title")}),d.jsxs("p",{style:Tt,children:[e("terms_description")," ",d.jsx("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",style:Xu,children:e("terms_and_conditions")}),"."]}),u&&d.jsx("p",{style:{color:"red",marginTop:"1rem"},children:u})]});case 4:return console.log("🧭 Entrando al paso 4 (plan), settings:",l),l&&d.jsxs(d.Fragment,{children:[d.jsx("h2",{style:rr,children:e("your_plan_title")}),d.jsxs("p",{style:Tt,children:[e("current_plan")," ",d.jsx("strong",{children:((x=l.plan)==null?void 0:x.name)||"Free"})]})]});default:return null}};return d.jsx("div",{style:Vu,children:d.jsxs("div",{style:Ku,children:[d.jsx("div",{style:Qu,children:Rt.map((x,w)=>d.jsxs("div",{style:{...Zu,backgroundColor:t===w+1?"#4a90e2":"#f5a623",color:t===w+1?"white":"#274472"},children:[e(x),w!==Rt.length-1&&d.jsx("span",{style:eh,children:"→"})]},w))}),v(),d.jsxs("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"flex-end"},children:[t>1&&d.jsx("button",{onClick:p,style:Yu,children:e("back")}),t<Rt.length?d.jsx("button",{onClick:y,style:Cs,children:e("next")}):d.jsx("button",{onClick:f,style:Cs,disabled:s,children:e(s?"loading":"start")})]})]})})}const Vu={position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(8px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},Ku={backgroundColor:"#1b2a41",padding:"3rem",borderRadius:"1.5rem",textAlign:"center",maxWidth:"700px",width:"90%",boxShadow:"0 0 30px rgba(0,0,0,0.3)",border:"1px solid #274472"},rr={fontSize:"1.8rem",color:"#a3d9b1",marginBottom:"1rem"},Tt={fontSize:"1rem",color:"#ededed",marginBottom:"1.5rem"},Gu={display:"flex",flexDirection:"column",gap:"1rem",marginTop:"1rem"},nr={padding:"0.8rem",borderRadius:"8px",border:"1px solid #4a90e2",backgroundColor:"#1b2a41",color:"white",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",backgroundImage:`url("data:image/svg+xml;charset=UTF-8,%3Csvg viewBox='0 0 140 140' xmlns='http://www.w3.org/2000/svg'%3E%3Cpolygon points='70,100 20,40 120,40' fill='%23ffffff'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 1rem center",backgroundSize:"12px"},Cs={backgroundColor:"#2eb39a",color:"white",padding:"0.8rem 1.6rem",border:"none",borderRadius:"8px",fontWeight:"bold",cursor:"pointer"},Yu={backgroundColor:"#274472",color:"white",padding:"0.8rem 1.6rem",border:"none",borderRadius:"8px",fontWeight:"bold",cursor:"pointer"},Xu={color:"#4a90e2",textDecoration:"underline"},Qu={display:"flex",justifyContent:"center",gap:"0.8rem",marginBottom:"2rem",flexWrap:"wrap",alignItems:"center"},Zu={padding:"0.5rem 1rem",borderRadius:"999px",fontSize:"0.9rem",fontWeight:"bold",textAlign:"center",minWidth:"120px"},eh={margin:"0 0.5rem",color:"#ededed",fontSize:"1.2rem"};function th(){var b;const[r,e]=g.useState(null),[t,n]=g.useState(null),[s,i]=g.useState(!1),o=Ee(),{t:a}=W();if(g.useEffect(()=>{(async()=>{const{data:v,error:x}=await Z.auth.getUser();x&&console.error("❌ Error obteniendo usuario:",x),v!=null&&v.user?n(v.user):n(null)})()},[]),g.useEffect(()=>{(async()=>{if(!o){console.warn("⚠️ client_id no disponible aún");return}try{const v=await fetch(`http://localhost:8001/dashboard_summary?client_id=${o}`),x=await v.json();v.ok?e(x):console.error("❌ Error en respuesta de dashboard_summary:",x)}catch(v){console.error("❌ Error de red al obtener dashboard:",v)}})()},[o]),g.useEffect(()=>{const m=sessionStorage.getItem("alreadyRedirected");console.log("🔄 alreadyRedirected:",m),m!=="true"&&i(!0)},[]),!t||!r)return d.jsx("div",{style:{color:"white",padding:"2rem"},children:a("loading")});const{plan:l,usage:c,history_preview:u,documents_preview:h,assistant_config:f}=r,y=m=>m.toLowerCase().replace(/\s+/g,"_"),p=((b=l==null?void 0:l.plan_features)==null?void 0:b.map(m=>y(m)))||[];return d.jsxs("div",{style:{backgroundColor:s?"rgba(15,28,46,0.7)":"#0f1c2e",minHeight:"100vh",padding:"2rem",fontFamily:"system-ui, sans-serif",color:"white",overflow:"hidden"},children:[s&&d.jsx(Ju,{onClose:()=>{console.log("📴 Cerrando WelcomeModal"),i(!1)}}),d.jsxs("h1",{style:{fontSize:"1.8rem",fontWeight:"bold",color:"#f5a623",marginBottom:"0.5rem"},children:["👋 ",a("welcome"),", ",t.email]}),d.jsxs("p",{style:{color:"#ededed",marginBottom:"2rem"},children:[a("assistant_intro")," ",d.jsx("strong",{style:{color:"#a3d9b1"},children:(f==null?void 0:f.assistant_name)||a("your_assistant")}),"."]}),d.jsxs("div",{style:sr,children:[d.jsx("h2",{style:ir,children:a("your_plan")}),d.jsx("p",{children:d.jsx("strong",{children:l.name})}),d.jsxs("p",{children:[a("messages"),": ",l.is_unlimited?"∞":l.max_messages]}),d.jsxs("p",{children:[a("documents"),": ",l.max_documents]})]}),d.jsxs("div",{style:sr,children:[d.jsx("h2",{style:ir,children:a("active_features")}),d.jsx("ul",{children:p.length>0?p.map(m=>d.jsxs("li",{style:{marginBottom:"0.5rem"},children:["✅ ",a(m)]},m)):d.jsx("li",{children:a("no_features")})})]}),d.jsxs("div",{style:sr,children:[d.jsx("h2",{style:ir,children:a("recent_activity")}),u&&u.length>0?d.jsx("ul",{children:u.map((m,v)=>d.jsxs("li",{style:{marginBottom:"0.5rem"},children:[m.question," (",new Date(m.timestamp).toLocaleDateString(),")"]},v))}):d.jsx("p",{children:a("no_history")})]}),d.jsxs("div",{style:sr,children:[d.jsx("h2",{style:ir,children:a("recent_documents")}),h&&h.length>0?d.jsx("ul",{children:h.map((m,v)=>d.jsxs("li",{style:{marginBottom:"0.5rem"},children:[m.filename," ",m.uploaded_at?`(${new Date(m.uploaded_at).toLocaleDateString()})`:""]},v))}):d.jsx("p",{children:a("no_documents")})]})]})}const sr={backgroundColor:"#1b2a41",border:"1px solid #274472",borderRadius:"1rem",padding:"1.5rem",marginBottom:"2rem",boxShadow:"0 4px 10px rgba(0,0,0,0.2)"},ir={fontSize:"1.3rem",color:"#4a90e2",marginBottom:"1rem",fontWeight:"bold"};function rh(){const[r,e]=g.useState(null),[t,n]=g.useState(""),[s,i]=g.useState([]),[o,a]=g.useState(!1),l=Ee(),{t:c}=W(),u=async()=>{if(l)try{const y=await(await fetch(`http://localhost:8001/list_files?client_id=${l}`)).json();i(y.files||[])}catch(f){console.error("❌ Error al listar archivos:",f),i([])}};g.useEffect(()=>{l&&u()},[l]);const h=async f=>{if(f.preventDefault(),!l||l==="undefined"||l.trim()===""){n(`❌ ${c("invalid_client_id")}`);return}if(!r){n(`⚠️ ${c("please_select_file")}`);return}const y=new FormData;y.append("client_id",l),y.append("file",r);try{const p=await fetch("http://localhost:8001/upload_document",{method:"POST",body:y});if(p.status===403){const m=await p.json(),v=(m==null?void 0:m.detail)||"";a(!0),n(v==="limit_reached"?`🚫 ${c("limit_reached_error")}`:`🚫 ${v||c("unknown_upload_error")}`);return}if(!p.ok){const m=await p.json();throw new Error(m.detail||c("unknown_upload_error"))}const b=await p.json();console.log("📥 Respuesta backend:",b),n(`✅ ${b.message||c("file_uploaded_success")}`),e(null),u()}catch(p){console.error("❌ Error al subir archivo:",p),n(`❌ ${p.message}`)}};return d.jsx("div",{style:{backgroundColor:"#0f1c2e",minHeight:"100vh",padding:"2rem",fontFamily:"system-ui, sans-serif",color:"white",display:"flex",justifyContent:"center",alignItems:"flex-start"},children:d.jsxs("div",{style:{backgroundColor:"#1b2a41",padding:"2rem",borderRadius:"16px",maxWidth:"600px",width:"100%",boxShadow:"0 10px 30px rgba(0,0,0,0.2)",border:"1px solid #274472"},children:[d.jsxs("h1",{style:{fontSize:"1.8rem",marginBottom:"1rem",color:"#f5a623"},children:["📤 ",c("upload_document")]}),d.jsxs("form",{onSubmit:h,children:[d.jsxs("div",{style:{marginBottom:"1.2rem"},children:[d.jsxs("label",{style:{display:"block",marginBottom:"0.5rem",color:"#ededed"},children:["📎 ",c("select_file_label")]}),d.jsx("input",{type:"file",accept:".pdf,.txt",onChange:f=>e(f.target.files[0]),disabled:o,style:{width:"100%",padding:"0.4rem",backgroundColor:"#0f1c2e",border:"1px solid #4a90e2",color:"white",borderRadius:"8px",cursor:o?"not-allowed":"pointer"}})]}),d.jsx("button",{type:"submit",disabled:o,style:{backgroundColor:o?"#777":"#4a90e2",padding:"0.7rem 1.2rem",color:"white",borderRadius:"8px",fontWeight:"bold",border:"none",cursor:o?"not-allowed":"pointer",transition:"background 0.3s ease"},children:c("upload_file")})]}),t&&d.jsx("p",{style:{marginTop:"1rem",fontWeight:"500",color:"#a3d9b1"},children:t}),s.length>0&&d.jsxs("div",{style:{marginTop:"2rem"},children:[d.jsxs("h3",{style:{color:"#f5a623",marginBottom:"0.75rem"},children:["📂 ",c("uploaded_files")]}),d.jsx("ul",{style:{listStyleType:"none",paddingLeft:0},children:s.map((f,y)=>d.jsxs("li",{style:{marginBottom:"0.5rem",color:"#ededed"},children:["📄 ",f.name," – ",f.size_kb," KB"]},y))})]})]})})}function Ui(r,e){return function(){return r.apply(e,arguments)}}const{toString:nh}=Object.prototype,{getPrototypeOf:Pn}=Object,jr=(r=>e=>{const t=nh.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),ve=r=>(r=r.toLowerCase(),e=>jr(e)===r),Er=r=>e=>typeof e===r,{isArray:gt}=Array,Ft=Er("undefined");function sh(r){return r!==null&&!Ft(r)&&r.constructor!==null&&!Ft(r.constructor)&&oe(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const Fi=ve("ArrayBuffer");function ih(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&Fi(r.buffer),e}const oh=Er("string"),oe=Er("function"),zi=Er("number"),kr=r=>r!==null&&typeof r=="object",ah=r=>r===!0||r===!1,ur=r=>{if(jr(r)!=="object")return!1;const e=Pn(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},lh=ve("Date"),ch=ve("File"),dh=ve("Blob"),uh=ve("FileList"),hh=r=>kr(r)&&oe(r.pipe),fh=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||oe(r.append)&&((e=jr(r))==="formdata"||e==="object"&&oe(r.toString)&&r.toString()==="[object FormData]"))},ph=ve("URLSearchParams"),[mh,gh,yh,bh]=["ReadableStream","Request","Response","Headers"].map(ve),vh=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wt(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r>"u")return;let n,s;if(typeof r!="object"&&(r=[r]),gt(r))for(n=0,s=r.length;n<s;n++)e.call(null,r[n],n,r);else{const i=t?Object.getOwnPropertyNames(r):Object.keys(r),o=i.length;let a;for(n=0;n<o;n++)a=i[n],e.call(null,r[a],a,r)}}function Mi(r,e){e=e.toLowerCase();const t=Object.keys(r);let n=t.length,s;for(;n-- >0;)if(s=t[n],e===s.toLowerCase())return s;return null}const He=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,qi=r=>!Ft(r)&&r!==He;function an(){const{caseless:r}=qi(this)&&this||{},e={},t=(n,s)=>{const i=r&&Mi(e,s)||s;ur(e[i])&&ur(n)?e[i]=an(e[i],n):ur(n)?e[i]=an({},n):gt(n)?e[i]=n.slice():e[i]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&Wt(arguments[n],t);return e}const wh=(r,e,t,{allOwnKeys:n}={})=>(Wt(e,(s,i)=>{t&&oe(s)?r[i]=Ui(s,t):r[i]=s},{allOwnKeys:n}),r),_h=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),xh=(r,e,t,n)=>{r.prototype=Object.create(e.prototype,n),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},Sh=(r,e,t,n)=>{let s,i,o;const a={};if(e=e||{},r==null)return e;do{for(s=Object.getOwnPropertyNames(r),i=s.length;i-- >0;)o=s[i],(!n||n(o,r,e))&&!a[o]&&(e[o]=r[o],a[o]=!0);r=t!==!1&&Pn(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},jh=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;const n=r.indexOf(e,t);return n!==-1&&n===t},Eh=r=>{if(!r)return null;if(gt(r))return r;let e=r.length;if(!zi(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},kh=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&Pn(Uint8Array)),Ch=(r,e)=>{const n=(r&&r[Symbol.iterator]).call(r);let s;for(;(s=n.next())&&!s.done;){const i=s.value;e.call(r,i[0],i[1])}},Rh=(r,e)=>{let t;const n=[];for(;(t=r.exec(e))!==null;)n.push(t);return n},Th=ve("HTMLFormElement"),Ph=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,s){return n.toUpperCase()+s}),Rs=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),Ah=ve("RegExp"),Wi=(r,e)=>{const t=Object.getOwnPropertyDescriptors(r),n={};Wt(t,(s,i)=>{let o;(o=e(s,i,r))!==!1&&(n[i]=o||s)}),Object.defineProperties(r,n)},Oh=r=>{Wi(r,(e,t)=>{if(oe(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=r[t];if(oe(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},$h=(r,e)=>{const t={},n=s=>{s.forEach(i=>{t[i]=!0})};return gt(r)?n(r):n(String(r).split(e)),t},Ih=()=>{},Lh=(r,e)=>r!=null&&Number.isFinite(r=+r)?r:e;function Dh(r){return!!(r&&oe(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const Bh=r=>{const e=new Array(10),t=(n,s)=>{if(kr(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[s]=n;const i=gt(n)?[]:{};return Wt(n,(o,a)=>{const l=t(o,s+1);!Ft(l)&&(i[a]=l)}),e[s]=void 0,i}}return n};return t(r,0)},Nh=ve("AsyncFunction"),Uh=r=>r&&(kr(r)||oe(r))&&oe(r.then)&&oe(r.catch),Hi=((r,e)=>r?setImmediate:e?((t,n)=>(He.addEventListener("message",({source:s,data:i})=>{s===He&&i===t&&n.length&&n.shift()()},!1),s=>{n.push(s),He.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",oe(He.postMessage)),Fh=typeof queueMicrotask<"u"?queueMicrotask.bind(He):typeof process<"u"&&process.nextTick||Hi,_={isArray:gt,isArrayBuffer:Fi,isBuffer:sh,isFormData:fh,isArrayBufferView:ih,isString:oh,isNumber:zi,isBoolean:ah,isObject:kr,isPlainObject:ur,isReadableStream:mh,isRequest:gh,isResponse:yh,isHeaders:bh,isUndefined:Ft,isDate:lh,isFile:ch,isBlob:dh,isRegExp:Ah,isFunction:oe,isStream:hh,isURLSearchParams:ph,isTypedArray:kh,isFileList:uh,forEach:Wt,merge:an,extend:wh,trim:vh,stripBOM:_h,inherits:xh,toFlatObject:Sh,kindOf:jr,kindOfTest:ve,endsWith:jh,toArray:Eh,forEachEntry:Ch,matchAll:Rh,isHTMLForm:Th,hasOwnProperty:Rs,hasOwnProp:Rs,reduceDescriptors:Wi,freezeMethods:Oh,toObjectSet:$h,toCamelCase:Ph,noop:Ih,toFiniteNumber:Lh,findKey:Mi,global:He,isContextDefined:qi,isSpecCompliantForm:Dh,toJSONObject:Bh,isAsyncFn:Nh,isThenable:Uh,setImmediate:Hi,asap:Fh};function k(r,e,t,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}_.inherits(k,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:_.toJSONObject(this.config),code:this.code,status:this.status}}});const Ji=k.prototype,Vi={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{Vi[r]={value:r}});Object.defineProperties(k,Vi);Object.defineProperty(Ji,"isAxiosError",{value:!0});k.from=(r,e,t,n,s,i)=>{const o=Object.create(Ji);return _.toFlatObject(r,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),k.call(o,r.message,e,t,n,s),o.cause=r,o.name=r.name,i&&Object.assign(o,i),o};const zh=null;function ln(r){return _.isPlainObject(r)||_.isArray(r)}function Ki(r){return _.endsWith(r,"[]")?r.slice(0,-2):r}function Ts(r,e,t){return r?r.concat(e).map(function(s,i){return s=Ki(s),!t&&i?"["+s+"]":s}).join(t?".":""):e}function Mh(r){return _.isArray(r)&&!r.some(ln)}const qh=_.toFlatObject(_,{},null,function(e){return/^is[A-Z]/.test(e)});function Cr(r,e,t){if(!_.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=_.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,m){return!_.isUndefined(m[b])});const n=t.metaTokens,s=t.visitor||u,i=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&_.isSpecCompliantForm(e);if(!_.isFunction(s))throw new TypeError("visitor must be a function");function c(p){if(p===null)return"";if(_.isDate(p))return p.toISOString();if(!l&&_.isBlob(p))throw new k("Blob is not supported. Use a Buffer instead.");return _.isArrayBuffer(p)||_.isTypedArray(p)?l&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function u(p,b,m){let v=p;if(p&&!m&&typeof p=="object"){if(_.endsWith(b,"{}"))b=n?b:b.slice(0,-2),p=JSON.stringify(p);else if(_.isArray(p)&&Mh(p)||(_.isFileList(p)||_.endsWith(b,"[]"))&&(v=_.toArray(p)))return b=Ki(b),v.forEach(function(w,S){!(_.isUndefined(w)||w===null)&&e.append(o===!0?Ts([b],S,i):o===null?b:b+"[]",c(w))}),!1}return ln(p)?!0:(e.append(Ts(m,b,i),c(p)),!1)}const h=[],f=Object.assign(qh,{defaultVisitor:u,convertValue:c,isVisitable:ln});function y(p,b){if(!_.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+b.join("."));h.push(p),_.forEach(p,function(v,x){(!(_.isUndefined(v)||v===null)&&s.call(e,v,_.isString(x)?x.trim():x,b,f))===!0&&y(v,b?b.concat(x):[x])}),h.pop()}}if(!_.isObject(r))throw new TypeError("data must be an object");return y(r),e}function Ps(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function An(r,e){this._pairs=[],r&&Cr(r,this,e)}const Gi=An.prototype;Gi.append=function(e,t){this._pairs.push([e,t])};Gi.toString=function(e){const t=e?function(n){return e.call(this,n,Ps)}:Ps;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function Wh(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Yi(r,e,t){if(!e)return r;const n=t&&t.encode||Wh;_.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let i;if(s?i=s(e,t):i=_.isURLSearchParams(e)?e.toString():new An(e,t).toString(n),i){const o=r.indexOf("#");o!==-1&&(r=r.slice(0,o)),r+=(r.indexOf("?")===-1?"?":"&")+i}return r}class As{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){_.forEach(this.handlers,function(n){n!==null&&e(n)})}}const Xi={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Hh=typeof URLSearchParams<"u"?URLSearchParams:An,Jh=typeof FormData<"u"?FormData:null,Vh=typeof Blob<"u"?Blob:null,Kh={isBrowser:!0,classes:{URLSearchParams:Hh,FormData:Jh,Blob:Vh},protocols:["http","https","file","blob","url","data"]},On=typeof window<"u"&&typeof document<"u",cn=typeof navigator=="object"&&navigator||void 0,Gh=On&&(!cn||["ReactNative","NativeScript","NS"].indexOf(cn.product)<0),Yh=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Xh=On&&window.location.href||"http://localhost",Qh=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:On,hasStandardBrowserEnv:Gh,hasStandardBrowserWebWorkerEnv:Yh,navigator:cn,origin:Xh},Symbol.toStringTag,{value:"Module"})),Q={...Qh,...Kh};function Zh(r,e){return Cr(r,new Q.classes.URLSearchParams,Object.assign({visitor:function(t,n,s,i){return Q.isNode&&_.isBuffer(t)?(this.append(n,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function ef(r){return _.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function tf(r){const e={},t=Object.keys(r);let n;const s=t.length;let i;for(n=0;n<s;n++)i=t[n],e[i]=r[i];return e}function Qi(r){function e(t,n,s,i){let o=t[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=i>=t.length;return o=!o&&_.isArray(s)?s.length:o,l?(_.hasOwnProp(s,o)?s[o]=[s[o],n]:s[o]=n,!a):((!s[o]||!_.isObject(s[o]))&&(s[o]=[]),e(t,n,s[o],i)&&_.isArray(s[o])&&(s[o]=tf(s[o])),!a)}if(_.isFormData(r)&&_.isFunction(r.entries)){const t={};return _.forEachEntry(r,(n,s)=>{e(ef(n),s,t,0)}),t}return null}function rf(r,e,t){if(_.isString(r))try{return(e||JSON.parse)(r),_.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(r)}const Ht={transitional:Xi,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",s=n.indexOf("application/json")>-1,i=_.isObject(e);if(i&&_.isHTMLForm(e)&&(e=new FormData(e)),_.isFormData(e))return s?JSON.stringify(Qi(e)):e;if(_.isArrayBuffer(e)||_.isBuffer(e)||_.isStream(e)||_.isFile(e)||_.isBlob(e)||_.isReadableStream(e))return e;if(_.isArrayBufferView(e))return e.buffer;if(_.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Zh(e,this.formSerializer).toString();if((a=_.isFileList(e))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Cr(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return i||s?(t.setContentType("application/json",!1),rf(e)):e}],transformResponse:[function(e){const t=this.transitional||Ht.transitional,n=t&&t.forcedJSONParsing,s=this.responseType==="json";if(_.isResponse(e)||_.isReadableStream(e))return e;if(e&&_.isString(e)&&(n&&!this.responseType||s)){const o=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?k.from(a,k.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Q.classes.FormData,Blob:Q.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};_.forEach(["delete","get","head","post","put","patch"],r=>{Ht.headers[r]={}});const nf=_.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),sf=r=>{const e={};let t,n,s;return r&&r.split(`
`).forEach(function(o){s=o.indexOf(":"),t=o.substring(0,s).trim().toLowerCase(),n=o.substring(s+1).trim(),!(!t||e[t]&&nf[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e},Os=Symbol("internals");function Pt(r){return r&&String(r).trim().toLowerCase()}function hr(r){return r===!1||r==null?r:_.isArray(r)?r.map(hr):String(r)}function of(r){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(r);)e[n[1]]=n[2];return e}const af=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function Wr(r,e,t,n,s){if(_.isFunction(n))return n.call(this,e,t);if(s&&(e=t),!!_.isString(e)){if(_.isString(n))return e.indexOf(n)!==-1;if(_.isRegExp(n))return n.test(e)}}function lf(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function cf(r,e){const t=_.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+t,{value:function(s,i,o){return this[n].call(this,e,s,i,o)},configurable:!0})})}let re=class{constructor(e){e&&this.set(e)}set(e,t,n){const s=this;function i(a,l,c){const u=Pt(l);if(!u)throw new Error("header name must be a non-empty string");const h=_.findKey(s,u);(!h||s[h]===void 0||c===!0||c===void 0&&s[h]!==!1)&&(s[h||l]=hr(a))}const o=(a,l)=>_.forEach(a,(c,u)=>i(c,u,l));if(_.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(_.isString(e)&&(e=e.trim())&&!af(e))o(sf(e),t);else if(_.isHeaders(e))for(const[a,l]of e.entries())i(l,a,n);else e!=null&&i(t,e,n);return this}get(e,t){if(e=Pt(e),e){const n=_.findKey(this,e);if(n){const s=this[n];if(!t)return s;if(t===!0)return of(s);if(_.isFunction(t))return t.call(this,s,n);if(_.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Pt(e),e){const n=_.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||Wr(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let s=!1;function i(o){if(o=Pt(o),o){const a=_.findKey(n,o);a&&(!t||Wr(n,n[a],a,t))&&(delete n[a],s=!0)}}return _.isArray(e)?e.forEach(i):i(e),s}clear(e){const t=Object.keys(this);let n=t.length,s=!1;for(;n--;){const i=t[n];(!e||Wr(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const t=this,n={};return _.forEach(this,(s,i)=>{const o=_.findKey(n,i);if(o){t[o]=hr(s),delete t[i];return}const a=e?lf(i):String(i).trim();a!==i&&delete t[i],t[a]=hr(s),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return _.forEach(this,(n,s)=>{n!=null&&n!==!1&&(t[s]=e&&_.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(s=>n.set(s)),n}static accessor(e){const n=(this[Os]=this[Os]={accessors:{}}).accessors,s=this.prototype;function i(o){const a=Pt(o);n[a]||(cf(s,o),n[a]=!0)}return _.isArray(e)?e.forEach(i):i(e),this}};re.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);_.reduceDescriptors(re.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(n){this[t]=n}}});_.freezeMethods(re);function Hr(r,e){const t=this||Ht,n=e||t,s=re.from(n.headers);let i=n.data;return _.forEach(r,function(a){i=a.call(t,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function Zi(r){return!!(r&&r.__CANCEL__)}function yt(r,e,t){k.call(this,r??"canceled",k.ERR_CANCELED,e,t),this.name="CanceledError"}_.inherits(yt,k,{__CANCEL__:!0});function eo(r,e,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?r(t):e(new k("Request failed with status code "+t.status,[k.ERR_BAD_REQUEST,k.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function df(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function uf(r,e){r=r||10;const t=new Array(r),n=new Array(r);let s=0,i=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=n[i];o||(o=c),t[s]=l,n[s]=c;let h=i,f=0;for(;h!==s;)f+=t[h++],h=h%r;if(s=(s+1)%r,s===i&&(i=(i+1)%r),c-o<e)return;const y=u&&c-u;return y?Math.round(f*1e3/y):void 0}}function hf(r,e){let t=0,n=1e3/e,s,i;const o=(c,u=Date.now())=>{t=u,s=null,i&&(clearTimeout(i),i=null),r.apply(null,c)};return[(...c)=>{const u=Date.now(),h=u-t;h>=n?o(c,u):(s=c,i||(i=setTimeout(()=>{i=null,o(s)},n-h)))},()=>s&&o(s)]}const br=(r,e,t=3)=>{let n=0;const s=uf(50,250);return hf(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,l=o-n,c=s(l),u=o<=a;n=o;const h={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:i,lengthComputable:a!=null,[e?"download":"upload"]:!0};r(h)},t)},$s=(r,e)=>{const t=r!=null;return[n=>e[0]({lengthComputable:t,total:r,loaded:n}),e[1]]},Is=r=>(...e)=>_.asap(()=>r(...e)),ff=Q.hasStandardBrowserEnv?((r,e)=>t=>(t=new URL(t,Q.origin),r.protocol===t.protocol&&r.host===t.host&&(e||r.port===t.port)))(new URL(Q.origin),Q.navigator&&/(msie|trident)/i.test(Q.navigator.userAgent)):()=>!0,pf=Q.hasStandardBrowserEnv?{write(r,e,t,n,s,i){const o=[r+"="+encodeURIComponent(e)];_.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),_.isString(n)&&o.push("path="+n),_.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(r){const e=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function mf(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function gf(r,e){return e?r.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):r}function to(r,e,t){let n=!mf(e);return r&&(n||t==!1)?gf(r,e):e}const Ls=r=>r instanceof re?{...r}:r;function Ve(r,e){e=e||{};const t={};function n(c,u,h,f){return _.isPlainObject(c)&&_.isPlainObject(u)?_.merge.call({caseless:f},c,u):_.isPlainObject(u)?_.merge({},u):_.isArray(u)?u.slice():u}function s(c,u,h,f){if(_.isUndefined(u)){if(!_.isUndefined(c))return n(void 0,c,h,f)}else return n(c,u,h,f)}function i(c,u){if(!_.isUndefined(u))return n(void 0,u)}function o(c,u){if(_.isUndefined(u)){if(!_.isUndefined(c))return n(void 0,c)}else return n(void 0,u)}function a(c,u,h){if(h in e)return n(c,u);if(h in r)return n(void 0,c)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,h)=>s(Ls(c),Ls(u),h,!0)};return _.forEach(Object.keys(Object.assign({},r,e)),function(u){const h=l[u]||s,f=h(r[u],e[u],u);_.isUndefined(f)&&h!==a||(t[u]=f)}),t}const ro=r=>{const e=Ve({},r);let{data:t,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:a}=e;e.headers=o=re.from(o),e.url=Yi(to(e.baseURL,e.url,e.allowAbsoluteUrls),r.params,r.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(_.isFormData(t)){if(Q.hasStandardBrowserEnv||Q.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...u]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...u].join("; "))}}if(Q.hasStandardBrowserEnv&&(n&&_.isFunction(n)&&(n=n(e)),n||n!==!1&&ff(e.url))){const c=s&&i&&pf.read(i);c&&o.set(s,c)}return e},yf=typeof XMLHttpRequest<"u",bf=yf&&function(r){return new Promise(function(t,n){const s=ro(r);let i=s.data;const o=re.from(s.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=s,u,h,f,y,p;function b(){y&&y(),p&&p(),s.cancelToken&&s.cancelToken.unsubscribe(u),s.signal&&s.signal.removeEventListener("abort",u)}let m=new XMLHttpRequest;m.open(s.method.toUpperCase(),s.url,!0),m.timeout=s.timeout;function v(){if(!m)return;const w=re.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),E={data:!a||a==="text"||a==="json"?m.responseText:m.response,status:m.status,statusText:m.statusText,headers:w,config:r,request:m};eo(function(O){t(O),b()},function(O){n(O),b()},E),m=null}"onloadend"in m?m.onloadend=v:m.onreadystatechange=function(){!m||m.readyState!==4||m.status===0&&!(m.responseURL&&m.responseURL.indexOf("file:")===0)||setTimeout(v)},m.onabort=function(){m&&(n(new k("Request aborted",k.ECONNABORTED,r,m)),m=null)},m.onerror=function(){n(new k("Network Error",k.ERR_NETWORK,r,m)),m=null},m.ontimeout=function(){let S=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const E=s.transitional||Xi;s.timeoutErrorMessage&&(S=s.timeoutErrorMessage),n(new k(S,E.clarifyTimeoutError?k.ETIMEDOUT:k.ECONNABORTED,r,m)),m=null},i===void 0&&o.setContentType(null),"setRequestHeader"in m&&_.forEach(o.toJSON(),function(S,E){m.setRequestHeader(E,S)}),_.isUndefined(s.withCredentials)||(m.withCredentials=!!s.withCredentials),a&&a!=="json"&&(m.responseType=s.responseType),c&&([f,p]=br(c,!0),m.addEventListener("progress",f)),l&&m.upload&&([h,y]=br(l),m.upload.addEventListener("progress",h),m.upload.addEventListener("loadend",y)),(s.cancelToken||s.signal)&&(u=w=>{m&&(n(!w||w.type?new yt(null,r,m):w),m.abort(),m=null)},s.cancelToken&&s.cancelToken.subscribe(u),s.signal&&(s.signal.aborted?u():s.signal.addEventListener("abort",u)));const x=df(s.url);if(x&&Q.protocols.indexOf(x)===-1){n(new k("Unsupported protocol "+x+":",k.ERR_BAD_REQUEST,r));return}m.send(i||null)})},vf=(r,e)=>{const{length:t}=r=r?r.filter(Boolean):[];if(e||t){let n=new AbortController,s;const i=function(c){if(!s){s=!0,a();const u=c instanceof Error?c:this.reason;n.abort(u instanceof k?u:new yt(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,i(new k(`timeout ${e} of ms exceeded`,k.ETIMEDOUT))},e);const a=()=>{r&&(o&&clearTimeout(o),o=null,r.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),r=null)};r.forEach(c=>c.addEventListener("abort",i));const{signal:l}=n;return l.unsubscribe=()=>_.asap(a),l}},wf=function*(r,e){let t=r.byteLength;if(t<e){yield r;return}let n=0,s;for(;n<t;)s=n+e,yield r.slice(n,s),n=s},_f=async function*(r,e){for await(const t of xf(r))yield*wf(t,e)},xf=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const e=r.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}},Ds=(r,e,t,n)=>{const s=_f(r,e);let i=0,o,a=l=>{o||(o=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await s.next();if(c){a(),l.close();return}let h=u.byteLength;if(t){let f=i+=h;t(f)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),s.return()}},{highWaterMark:2})},Rr=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",no=Rr&&typeof ReadableStream=="function",Sf=Rr&&(typeof TextEncoder=="function"?(r=>e=>r.encode(e))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),so=(r,...e)=>{try{return!!r(...e)}catch{return!1}},jf=no&&so(()=>{let r=!1;const e=new Request(Q.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!e}),Bs=64*1024,dn=no&&so(()=>_.isReadableStream(new Response("").body)),vr={stream:dn&&(r=>r.body)};Rr&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!vr[e]&&(vr[e]=_.isFunction(r[e])?t=>t[e]():(t,n)=>{throw new k(`Response type '${e}' is not supported`,k.ERR_NOT_SUPPORT,n)})})})(new Response);const Ef=async r=>{if(r==null)return 0;if(_.isBlob(r))return r.size;if(_.isSpecCompliantForm(r))return(await new Request(Q.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(_.isArrayBufferView(r)||_.isArrayBuffer(r))return r.byteLength;if(_.isURLSearchParams(r)&&(r=r+""),_.isString(r))return(await Sf(r)).byteLength},kf=async(r,e)=>{const t=_.toFiniteNumber(r.getContentLength());return t??Ef(e)},Cf=Rr&&(async r=>{let{url:e,method:t,data:n,signal:s,cancelToken:i,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:h="same-origin",fetchOptions:f}=ro(r);c=c?(c+"").toLowerCase():"text";let y=vf([s,i&&i.toAbortSignal()],o),p;const b=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let m;try{if(l&&jf&&t!=="get"&&t!=="head"&&(m=await kf(u,n))!==0){let E=new Request(e,{method:"POST",body:n,duplex:"half"}),P;if(_.isFormData(n)&&(P=E.headers.get("content-type"))&&u.setContentType(P),E.body){const[O,L]=$s(m,br(Is(l)));n=Ds(E.body,Bs,O,L)}}_.isString(h)||(h=h?"include":"omit");const v="credentials"in Request.prototype;p=new Request(e,{...f,signal:y,method:t.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:v?h:void 0});let x=await fetch(p);const w=dn&&(c==="stream"||c==="response");if(dn&&(a||w&&b)){const E={};["status","statusText","headers"].forEach(D=>{E[D]=x[D]});const P=_.toFiniteNumber(x.headers.get("content-length")),[O,L]=a&&$s(P,br(Is(a),!0))||[];x=new Response(Ds(x.body,Bs,O,()=>{L&&L(),b&&b()}),E)}c=c||"text";let S=await vr[_.findKey(vr,c)||"text"](x,r);return!w&&b&&b(),await new Promise((E,P)=>{eo(E,P,{data:S,headers:re.from(x.headers),status:x.status,statusText:x.statusText,config:r,request:p})})}catch(v){throw b&&b(),v&&v.name==="TypeError"&&/fetch/i.test(v.message)?Object.assign(new k("Network Error",k.ERR_NETWORK,r,p),{cause:v.cause||v}):k.from(v,v&&v.code,r,p)}}),un={http:zh,xhr:bf,fetch:Cf};_.forEach(un,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const Ns=r=>`- ${r}`,Rf=r=>_.isFunction(r)||r===null||r===!1,io={getAdapter:r=>{r=_.isArray(r)?r:[r];const{length:e}=r;let t,n;const s={};for(let i=0;i<e;i++){t=r[i];let o;if(n=t,!Rf(t)&&(n=un[(o=String(t)).toLowerCase()],n===void 0))throw new k(`Unknown adapter '${o}'`);if(n)break;s[o||"#"+i]=n}if(!n){const i=Object.entries(s).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?i.length>1?`since :
`+i.map(Ns).join(`
`):" "+Ns(i[0]):"as no adapter specified";throw new k("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:un};function Jr(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new yt(null,r)}function Us(r){return Jr(r),r.headers=re.from(r.headers),r.data=Hr.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),io.getAdapter(r.adapter||Ht.adapter)(r).then(function(n){return Jr(r),n.data=Hr.call(r,r.transformResponse,n),n.headers=re.from(n.headers),n},function(n){return Zi(n)||(Jr(r),n&&n.response&&(n.response.data=Hr.call(r,r.transformResponse,n.response),n.response.headers=re.from(n.response.headers))),Promise.reject(n)})}const oo="1.8.4",Tr={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{Tr[r]=function(n){return typeof n===r||"a"+(e<1?"n ":" ")+r}});const Fs={};Tr.transitional=function(e,t,n){function s(i,o){return"[Axios v"+oo+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,a)=>{if(e===!1)throw new k(s(o," has been removed"+(t?" in "+t:"")),k.ERR_DEPRECATED);return t&&!Fs[o]&&(Fs[o]=!0,console.warn(s(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,o,a):!0}};Tr.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function Tf(r,e,t){if(typeof r!="object")throw new k("options must be an object",k.ERR_BAD_OPTION_VALUE);const n=Object.keys(r);let s=n.length;for(;s-- >0;){const i=n[s],o=e[i];if(o){const a=r[i],l=a===void 0||o(a,i,r);if(l!==!0)throw new k("option "+i+" must be "+l,k.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new k("Unknown option "+i,k.ERR_BAD_OPTION)}}const fr={assertOptions:Tf,validators:Tr},xe=fr.validators;let Je=class{constructor(e){this.defaults=e,this.interceptors={request:new As,response:new As}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ve(this.defaults,t);const{transitional:n,paramsSerializer:s,headers:i}=t;n!==void 0&&fr.assertOptions(n,{silentJSONParsing:xe.transitional(xe.boolean),forcedJSONParsing:xe.transitional(xe.boolean),clarifyTimeoutError:xe.transitional(xe.boolean)},!1),s!=null&&(_.isFunction(s)?t.paramsSerializer={serialize:s}:fr.assertOptions(s,{encode:xe.function,serialize:xe.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),fr.assertOptions(t,{baseUrl:xe.spelling("baseURL"),withXsrfToken:xe.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&_.merge(i.common,i[t.method]);i&&_.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),t.headers=re.concat(o,i);const a=[];let l=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(t)===!1||(l=l&&b.synchronous,a.unshift(b.fulfilled,b.rejected))});const c=[];this.interceptors.response.forEach(function(b){c.push(b.fulfilled,b.rejected)});let u,h=0,f;if(!l){const p=[Us.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,c),f=p.length,u=Promise.resolve(t);h<f;)u=u.then(p[h++],p[h++]);return u}f=a.length;let y=t;for(h=0;h<f;){const p=a[h++],b=a[h++];try{y=p(y)}catch(m){b.call(this,m);break}}try{u=Us.call(this,y)}catch(p){return Promise.reject(p)}for(h=0,f=c.length;h<f;)u=u.then(c[h++],c[h++]);return u}getUri(e){e=Ve(this.defaults,e);const t=to(e.baseURL,e.url,e.allowAbsoluteUrls);return Yi(t,e.params,e.paramsSerializer)}};_.forEach(["delete","get","head","options"],function(e){Je.prototype[e]=function(t,n){return this.request(Ve(n||{},{method:e,url:t,data:(n||{}).data}))}});_.forEach(["post","put","patch"],function(e){function t(n){return function(i,o,a){return this.request(Ve(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Je.prototype[e]=t(),Je.prototype[e+"Form"]=t(!0)});let Pf=class ao{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const n=this;this.promise.then(s=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](s);n._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(a=>{n.subscribe(a),i=a}).then(s);return o.cancel=function(){n.unsubscribe(i)},o},e(function(i,o,a){n.reason||(n.reason=new yt(i,o,a),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=n=>{e.abort(n)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new ao(function(s){e=s}),cancel:e}}};function Af(r){return function(t){return r.apply(null,t)}}function Of(r){return _.isObject(r)&&r.isAxiosError===!0}const hn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hn).forEach(([r,e])=>{hn[e]=r});function lo(r){const e=new Je(r),t=Ui(Je.prototype.request,e);return _.extend(t,Je.prototype,e,{allOwnKeys:!0}),_.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return lo(Ve(r,s))},t}const z=lo(Ht);z.Axios=Je;z.CanceledError=yt;z.CancelToken=Pf;z.isCancel=Zi;z.VERSION=oo;z.toFormData=Cr;z.AxiosError=k;z.Cancel=z.CanceledError;z.all=function(e){return Promise.all(e)};z.spread=Af;z.isAxiosError=Of;z.mergeConfig=Ve;z.AxiosHeaders=re;z.formToJSON=r=>Qi(_.isHTMLForm(r)?new FormData(r):r);z.getAdapter=io.getAdapter;z.HttpStatusCode=hn;z.default=z;const{Axios:Bp,AxiosError:Np,CanceledError:Up,isCancel:Fp,CancelToken:zp,VERSION:Mp,all:qp,Cancel:Wp,isAxiosError:Hp,spread:Jp,toFormData:Vp,AxiosHeaders:Kp,HttpStatusCode:Gp,formToJSON:Yp,getAdapter:Xp,mergeConfig:Qp}=z;function $f(){const[r,e]=g.useState([]),[t,n]=g.useState(!0),[s,i]=g.useState(0),o=Ee(),{t:a}=W();return g.useEffect(()=>{(async()=>{if(o){n(!0);try{const c=await z.get(`http://localhost:8001/history?client_id=${o}`);e(c.data.history||[])}catch(c){console.error("Error cargando historial",c),e([])}finally{n(!1)}}})()},[o,s]),d.jsx("div",{style:{backgroundColor:"#0f1c2e",minHeight:"100vh",padding:"2rem",fontFamily:"system-ui, sans-serif",color:"white",display:"flex",justifyContent:"center",alignItems:"flex-start"},children:d.jsxs("div",{style:{maxWidth:"800px",width:"100%",backgroundColor:"#1b2a41",padding:"2rem",borderRadius:"16px",boxShadow:"0 10px 30px rgba(0,0,0,0.2)",border:"1px solid #274472"},children:[d.jsxs("h2",{style:{fontSize:"1.8rem",fontWeight:"bold",color:"#f5a623",marginBottom:"1.5rem"},children:["📚 ",a("question_history")]}),t?d.jsxs("p",{style:{color:"#ededed"},children:["🔄 ",a("loading_history")]}):r.length===0?d.jsx("p",{style:{color:"#ededed"},children:a("no_questions_yet")}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:r.map(l=>d.jsxs("div",{style:{backgroundColor:"#ededed",color:"#1b2a41",padding:"1rem",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",border:"1px solid #a3d9b1"},children:[d.jsxs("p",{style:{marginBottom:"0.5rem"},children:[d.jsxs("strong",{children:["🧠 ",a("question"),":"]})," ",l.question]}),d.jsxs("p",{style:{marginBottom:"0.5rem"},children:[d.jsxs("strong",{children:["🤖 ",a("answer"),":"]})," ",l.answer]}),d.jsxs("p",{style:{fontSize:"0.85rem",color:"#4a90e2"},children:["🕒 ",new Date(l.created_at).toLocaleString()]})]},l.id))})]})})}const At=r=>/^\+\d{11,15}$/.test(r),Ot=r=>/^\d{10,20}$/.test(r),$t=r=>/^EA[A-Za-z0-9]{16,}$/.test(r);function If(){const{t:r}=W(),[e,t]=g.useState("meta"),[n,s]=g.useState(""),[i,o]=g.useState(""),[a,l]=g.useState(""),[c,u]=g.useState({phone:!1,waPhoneId:!1,waToken:!1}),[h,f]=g.useState(null),[y,p]=g.useState({message:"",type:""}),[b,m]=g.useState(!1),v=Ee();g.useEffect(()=>{const S=async()=>{const{data:{session:P}}=await Z.auth.getSession();f(P)},E=async()=>{try{const P=await z.get("http://localhost:8001/get_whatsapp_config",{params:{client_id:v}}),{phone:O,wa_phone_id:L,wa_token:D,provider:H}=P.data||{};O&&s(O),L&&o(L),D&&l(D),t(H==="meta"||H==="twilio"?H:"meta"),O&&(H==="twilio"||L&&D)&&m(!0)}catch(P){console.log("ℹ️ No config found or failed to fetch:",P)}};S(),E()},[v]);const x=async()=>{if(!h||!At(n)||e==="meta"&&(!Ot(i)||!$t(a)))return;const S={auth_user_id:h.user.id,email:h.user.email,phone:n,provider:e,wa_phone_id:e==="meta"?i:null,wa_token:e==="meta"?a:null};try{await z.post("http://localhost:8001/link_whatsapp",S),p({message:r("wa_success"),type:"success"}),m(!0)}catch(E){console.error(E),p({message:r("wa_error_linking"),type:"error"})}},w=(S,E)=>c[S]&&d.jsxs("p",{style:Nf,children:[S==="phone"&&!At(E)&&r("wa_error_phone"),S==="waPhoneId"&&!Ot(E)&&r("wa_error_phone_id"),S==="waToken"&&!$t(E)&&r("wa_error_token")]});return d.jsx("div",{style:Lf,children:d.jsxs("div",{style:Df,children:[d.jsx("div",{style:Uf,children:d.jsxs("h2",{style:Bf,children:["💬 ",r("wa_setup_title")]})}),d.jsxs("div",{style:ar,children:[d.jsx("label",{style:zs,children:r("wa_choose_provider")}),d.jsxs("select",{value:e,onChange:S=>t(S.target.value),disabled:b,style:{...or,backgroundColor:b?"#1b2a41":"#0f1c2e",color:b?"#aaa":"white",cursor:b?"not-allowed":"pointer",fontWeight:"bold",border:"1px solid #4a90e2",appearance:"none",backgroundImage:`url("data:image/svg+xml;utf8,<svg fill='white' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/></svg>")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.75rem center",paddingRight:"2rem",marginBottom:"1.5rem"},children:[d.jsx("option",{value:"meta",children:r("wa_provider_meta")}),d.jsx("option",{value:"twilio",children:r("wa_provider_twilio")})]})]}),d.jsxs("div",{style:ar,children:[d.jsx("label",{style:zs,children:r("wa_label_phone")}),d.jsx("input",{type:"text",placeholder:"+52XXXXXXXXXXXX",value:n,onChange:S=>s(S.target.value),onBlur:()=>u(S=>({...S,phone:!0})),disabled:b,style:or}),w("phone",n)]}),e==="meta"&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:ar,children:[d.jsx("input",{type:"text",placeholder:r("wa_placeholder_phone_id"),value:i,onChange:S=>o(S.target.value),onBlur:()=>u(S=>({...S,waPhoneId:!0})),disabled:b,style:or}),w("waPhoneId",i)]}),d.jsxs("div",{style:ar,children:[d.jsx("input",{type:"text",placeholder:r("wa_placeholder_token"),value:a,onChange:S=>l(S.target.value),onBlur:()=>u(S=>({...S,waToken:!0})),disabled:b,style:or}),w("waToken",a)]})]}),!b&&d.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[d.jsxs("button",{onClick:x,disabled:!At(n)||e==="meta"&&(!Ot(i)||!$t(a)),style:{...Ms,opacity:At(n)&&(e==="twilio"||Ot(i)&&$t(a))?1:.5,cursor:At(n)&&(e==="twilio"||Ot(i)&&$t(a))?"pointer":"not-allowed"},children:["📲 ",r("wa_button_link")]}),d.jsxs("button",{onClick:()=>window.history.back(),style:{...Ms,backgroundColor:"#ededed",color:"#1b2a41"},children:["⬅️ ",r("wa_button_back")]})]}),y.message&&d.jsx("p",{style:{marginTop:"1rem",fontWeight:"bold",color:y.type==="error"?"#f87171":"#a3d9b1"},children:y.message})]})})}const Lf={padding:"2rem",fontFamily:"system-ui, sans-serif",backgroundColor:"#0f1c2e",color:"white",minHeight:"100vh",display:"flex",justifyContent:"center"},Df={backgroundColor:"#1b2a41",padding:"2rem",borderRadius:"16px",maxWidth:"600px",width:"100%",boxShadow:"0 10px 30px rgba(0,0,0,0.2)",border:"1px solid #274472"},Bf={fontSize:"1.8rem",fontWeight:"bold",color:"#f5a623",margin:0},zs={fontWeight:600,fontSize:"0.95rem",color:"#ededed",marginBottom:"0.25rem"},or={width:"100%",padding:"0.6rem",borderRadius:"8px",border:"1px solid #4a90e2",marginBottom:"0.5rem",backgroundColor:"#0f1c2e",color:"white"},Nf={fontSize:"0.8rem",color:"#f87171",marginTop:"-0.5rem",marginBottom:"1rem"},ar={marginBottom:"1.5rem"},Ms={backgroundColor:"#4a90e2",color:"white",padding:"0.7rem 1.2rem",borderRadius:"8px",fontWeight:"bold",border:"none",cursor:"pointer"},Uf={display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"};function Ff(){return d.jsxs("div",{style:{padding:"2rem"},children:[d.jsx("h2",{style:{color:"#274472"},children:"🧰 Servicios Disponibles"}),d.jsxs("ul",{style:{marginTop:"1rem",fontSize:"1.1rem"},children:[d.jsx("li",{children:"🧠 Chat Assistant"}),d.jsx("li",{children:"✉️ Email"}),d.jsx("li",{children:"💬 WhatsApp"})]}),d.jsx("p",{style:{marginTop:"1rem",color:"#666"},children:"Usa el menú lateral para configurar cada servicio."})]})}const zf="http://localhost:8001";function co(){const[r,e]=g.useState(null),[t,n]=g.useState(null),[s,i]=g.useState(null),[o,a]=g.useState(!0),l=be(),c=ae(),u=["/","/login","/register","/confirm","/forgot-password","/reset-password","/verify-mfa","/welcome","/chat-widget","/widget","/widget-preview"];return g.useEffect(()=>{(async()=>{let f=0,y=null;for(console.log("%c🔄 Buscando sesión activa...","color: #4a90e2; font-weight: bold");!y&&f<5&&(y=(await Z.auth.getSession()).data.session,!y);)await new Promise(b=>setTimeout(b,300)),f++;if(!y||!y.user){console.warn("%c⛔ No hay sesión. Redirigiendo a /verify-mfa","color: #e74c3c; font-weight: bold"),e(null),n(null),i(null),a(!1),["/login","/register","/forgot-password","/reset-password"].includes(c.pathname)||l("/verify-mfa",{replace:!0});return}console.log(`%c✅ Sesión activa como: ${y.user.email}`,"color: #2ecc71; font-weight: bold");try{const p=await fetch(`${zf}/initialize_user`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({auth_user_id:y.user.id,email:y.user.email})});let b={};try{b=await p.json()}catch(v){console.error("%c❌ Error parsing JSON:","color: #e74c3c",v),b={}}if(!p.ok){console.error("%c❌ Error en /initialize_user:","color: #e74c3c; font-weight: bold",b),a(!1);return}console.log("%c📡 Datos de /initialize_user:","color: #3498db; font-weight: bold",b),e(y),n(b.client_id),i(b.public_client_id),localStorage.setItem("client_id",b.client_id),localStorage.setItem("public_client_id",b.public_client_id),localStorage.setItem("user_id",y.user.id),a(!1);const m=sessionStorage.getItem("alreadyRedirected");u.includes(c.pathname)?b.is_new_user&&!m?(console.log("%c📥 Usuario nuevo → Redirigiendo a /welcome","color: #f5a623; font-weight: bold"),sessionStorage.setItem("alreadyRedirected","true"),l("/welcome",{replace:!0})):!m&&c.pathname==="/login"?(console.log("%c🏠 Usuario existente. Redirigiendo a /dashboard","color: #f5a623; font-weight: bold"),l("/dashboard",{replace:!0})):console.log("%c🛑 Ruta pública correcta, no redirigir:","color: #3498db",c.pathname):console.log("%c🛑 Ruta privada detectada. No redirigir.","color: #3498db")}catch(p){console.error("%c❌ Error de red al llamar a /initialize_user:","color: #e74c3c; font-weight: bold",p),a(!1)}})()},[l,c.pathname]),{session:r,clientId:t,publicClientId:s,loading:o}}function Mf(){const{publicClientId:r,loading:e}=co(),{t}=W(),n=a=>{navigator.clipboard.writeText(a),alert(`📋 ${t("copied_to_clipboard")}`)},s=window.location.hostname.includes("localhost")?"http://localhost:5173":"https://evolvian.app",i=`<script>
  (function () {
    const iframe = document.createElement("iframe");
    iframe.src = "${s}/widget?public_client_id=${r||"TU_ID_PUBLICO"}";
    iframe.style.position = "fixed";
    iframe.style.bottom = "20px";
    iframe.style.right = "20px";
    iframe.style.width = "360px";
    iframe.style.height = "520px";
    iframe.style.border = "2px solid #4a90e2";
    iframe.style.borderRadius = "16px";
    iframe.style.backgroundColor = "#ededed";
    iframe.style.boxShadow = "0 6px 24px rgba(0,0,0,0.15)";
    iframe.style.zIndex = "9999";
    iframe.setAttribute("title", "Evolvian AI Widget");
    iframe.setAttribute("allow", "clipboard-write; microphone");
    document.body.appendChild(iframe);
  })();
<\/script>`,o=`<iframe
  src="${s}/widget?public_client_id=${r||"TU_ID_PUBLICO"}"
  style="width:360px;height:520px;border:2px solid #4a90e2;border-radius:16px;background-color:#ededed;box-shadow:0 6px 24px rgba(0,0,0,0.15);position:fixed;bottom:20px;right:20px;z-index:9999;"
  allow="clipboard-write; microphone"
  title="Evolvian AI Chat Widget"
></iframe>`;return e?d.jsx("div",{style:qs,children:d.jsxs("div",{style:{color:"#ededed"},children:["🔄 ",t("loading_setup")]})}):d.jsx("div",{style:qs,children:d.jsxs("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[d.jsxs("h2",{style:qf,children:["🧠 ",t("setup_evolvian_web")]}),d.jsx("p",{style:Wf,children:t("setup_description")}),d.jsxs("div",{style:Hf,children:[d.jsxs("div",{children:[d.jsxs("strong",{children:[t("your_public_id"),":"]})," ",d.jsx("span",{style:{color:"#a3d9b1"},children:r||t("not_available")})]}),d.jsx("button",{onClick:()=>n(r),disabled:!r,style:Jf(r),children:t("copy_id")})]}),d.jsxs("div",{style:Vf,children:[d.jsxs("div",{style:Ws,children:[d.jsxs("h3",{style:Hs,children:["🔹 ",t("option1_title")]}),d.jsxs("p",{style:Js,children:["💡 ",t("option1_hint")]}),d.jsxs("ol",{style:Vs,children:[d.jsxs("li",{children:["1. ",t("copy_script")]}),d.jsxs("li",{children:["2. ",t("paste_before_body")]})]}),d.jsx("pre",{style:Ks,children:i}),d.jsx("button",{onClick:()=>n(i),style:Gs,children:t("copy_script_button")})]}),d.jsxs("div",{style:Ws,children:[d.jsxs("h3",{style:Hs,children:["🔹 ",t("option2_title")]}),d.jsxs("p",{style:Js,children:["💡 ",t("option2_hint")]}),d.jsxs("ol",{style:Vs,children:[d.jsxs("li",{children:["1. ",t("copy_code")]}),d.jsxs("li",{children:["2. ",t("paste_before_body")]})]}),d.jsx("pre",{style:Ks,children:o}),d.jsx("button",{onClick:()=>n(o),style:Gs,children:t("copy_iframe")})]})]})]})})}const qs={padding:"2rem 3rem",fontFamily:"system-ui, sans-serif",backgroundColor:"#0f1c2e",color:"#ffffff",minHeight:"100vh"},qf={fontSize:"2rem",color:"#f5a623",fontWeight:"bold",marginBottom:"1rem"},Wf={color:"#ffffff",maxWidth:"800px",marginBottom:"2rem"},Hf={backgroundColor:"#1b2a41",padding:"1rem",borderRadius:"12px",marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"space-between",maxWidth:"600px"},Jf=r=>({backgroundColor:"#4a90e2",color:"white",border:"none",borderRadius:"8px",padding:"0.5rem 1rem",fontWeight:"bold",cursor:r?"pointer":"not-allowed",opacity:r?1:.5}),Vf={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"2rem",marginTop:"2rem"},Ws={display:"flex",flexDirection:"column",justifyContent:"space-between",backgroundColor:"#1b2a41",padding:"1.5rem",borderRadius:"12px",minHeight:"460px"},Hs={color:"#f5a623",fontSize:"1.2rem",marginBottom:"0.75rem"},Js={fontSize:"0.85rem",color:"#a3d9b1",marginBottom:"1rem"},Vs={fontSize:"0.85rem",marginBottom:"1rem"},Ks={background:"#ededed",color:"#274472",padding:"1rem",borderRadius:"8px",fontSize:"0.75rem",overflowX:"auto",marginBottom:"0.5rem"},Gs={backgroundColor:"#f5a623",color:"#1b2a41",border:"none",borderRadius:"8px",padding:"0.5rem 1rem",fontWeight:"bold",fontSize:"0.85rem",cursor:"pointer"};function Kf(){const[r,e]=g.useState(""),[t,n]=g.useState(!1),s=Ee(),{t:i}=W();g.useEffect(()=>{(async()=>{if(!s)return;const{data:l}=await Z.from("clients").select("email_forward").eq("id",s).single();l!=null&&l.email_forward&&e(l.email_forward)})()},[s]);const o=async()=>{if(!s||!r)return;const{error:a}=await Z.from("clients").update({email_forward:r}).eq("id",s);a||n(!0)};return d.jsx("div",{style:Gf,children:d.jsxs("div",{style:Yf,children:[d.jsxs("h2",{style:Xf,children:["✉️ ",i("setup_email_assistant")]}),d.jsx("p",{style:Ys,children:i("email_instructions_intro")}),d.jsx("code",{style:Qf,children:"contacto@tudominio.com → evolvian@correo.evolvian.app"}),d.jsx("p",{style:Ys,children:i("save_email_instruction")}),d.jsx("input",{type:"email",placeholder:i("email_placeholder"),value:r,onChange:a=>{e(a.target.value),n(!1)},style:Zf}),d.jsx("button",{onClick:o,style:ep,children:i("save_address")}),t&&d.jsxs("p",{style:{color:"#a3d9b1",fontSize:"0.95rem"},children:["✅ ",i("address_saved")]}),d.jsxs("div",{style:{marginTop:"2rem",fontSize:"0.9rem",color:"#ededed"},children:[d.jsx("p",{children:d.jsx("strong",{children:i("how_it_works")})}),d.jsxs("ul",{style:tp,children:[d.jsxs("li",{children:["1️⃣ ",i("step1")]}),d.jsxs("li",{children:["2️⃣ ",i("step2")]}),d.jsxs("li",{children:["3️⃣ ",i("step3")]})]})]})]})})}const Gf={backgroundColor:"#0f1c2e",minHeight:"100vh",padding:"2rem",fontFamily:"system-ui, sans-serif",color:"white",display:"flex",justifyContent:"center"},Yf={backgroundColor:"#1b2a41",padding:"2rem",borderRadius:"16px",maxWidth:"600px",width:"100%",boxShadow:"0 10px 30px rgba(0,0,0,0.2)",border:"1px solid #274472"},Xf={fontSize:"1.8rem",fontWeight:"bold",color:"#f5a623",marginBottom:"1.5rem"},Ys={marginBottom:"1rem"},Qf={backgroundColor:"#ededed",color:"#274472",padding:"0.6rem 1rem",borderRadius:"8px",display:"block",marginBottom:"1.5rem"},Zf={width:"100%",padding:"0.6rem",borderRadius:"8px",border:"1px solid #4a90e2",marginBottom:"1rem",backgroundColor:"#0f1c2e",color:"white"},ep={backgroundColor:"#4a90e2",color:"white",padding:"0.7rem 1.2rem",borderRadius:"8px",fontWeight:"bold",border:"none",cursor:"pointer",marginBottom:"1rem"},tp={marginTop:"0.5rem",paddingLeft:"1.2rem",lineHeight:"1.7"};function rp({children:r,...e}){return d.jsx("button",{className:"w-full py-2.5 bg-[#2eb39a] hover:bg-[#26a488] text-white font-semibold rounded-lg transition",...e,children:r})}function Xs({children:r}){return d.jsx("div",{className:"w-full max-w-md bg-[#1b2a41] border border-[#274472] rounded-2xl p-8 shadow-lg text-white",children:r})}const fn=X;function np(){const{t:r}=W(),e=Ee(),[t,n]=g.useState(!1),[s,i]=g.useState([]),o=ae(),a=be();g.useEffect(()=>{const c=new URLSearchParams(o.search);c.get("connected_calendar")==="true"&&(fn({title:r("calendar_connected_title"),description:r("calendar_connected_description")}),c.delete("connected_calendar"),a({pathname:o.pathname,search:c.toString()},{replace:!0}))},[o,a]),g.useEffect(()=>{e&&fetch(`/api/calendar/status?client_id=${e}`).then(c=>c.json()).then(c=>{if(c.connected){n(!0);const u=(c.available_slots||[]).filter(h=>typeof h=="string"||typeof h=="number");i(u)}}).catch(()=>{fn({title:r("calendar_error_title"),description:r("calendar_error_description"),variant:"destructive"})})},[e]);const l=()=>{const u=`http://localhost:8001/api/auth/google_calendar/init?client_id=${e}`;console.log("🔗 Redirigiendo a:",u),window.location.href=u};return d.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[d.jsx("h1",{className:"text-2xl font-bold mb-4",children:r("calendar_title")}),d.jsxs(Xs,{children:[d.jsx("p",{className:"mb-4",children:r("calendar_description")}),d.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[d.jsx(rp,{onClick:l,disabled:!e||t,children:r(t?"calendar_account_connected":"calendar_connect_button")}),t&&d.jsx("span",{className:"text-sm text-green-600 font-medium",children:r("calendar_active_connection")})]})]}),t&&d.jsx("div",{className:"mt-8",children:d.jsxs(Xs,{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:r("calendar_next_slots_title")}),s.length===0?d.jsx("p",{className:"text-sm text-gray-500",children:r("calendar_no_slots")}):d.jsx("ul",{className:"list-disc ml-5",children:s.map((c,u)=>{const h=new Date(c),f=!isNaN(h.getTime());return d.jsx("li",{className:"text-sm",children:f?h.toLocaleString():"⛔ Fecha inválida"},u)})})]})})]})}function sp({activeTab:r,formData:e,refetchSettings:t}){var p;const{t:n}=W();Ee();const s=ae(),[i,o]=g.useState(!1),a=[{id:"free",name:n("plan_free"),price:"$0",features:[n("feature_chat_widget"),n("feature_basic_usage")]},{id:"starter",name:n("plan_starter"),price:"$19/mo",features:[n("feature_chat_widget"),n("feature_email_support"),n("feature_higher_limits")]},{id:"premium",name:n("plan_premium"),price:"$49/mo",features:[n("feature_all_starter"),n("feature_whatsapp"),n("feature_googlecalendar"),n("feature_custom_prompt")]},{id:"white_label",name:n("plan_white_label"),price:"",features:[n("feature_all_premium"),n("feature_custom_branding"),n("feature_full_api"),n("feature_custom_needs")]}];function l(b){const m={year:"numeric",month:"short",day:"numeric"};return new Date(b).toLocaleDateString(void 0,m)}if(r!=="plan")return null;const c=e.plan||{id:"free",name:n("plan_free")},u=((p=c==null?void 0:c.id)==null?void 0:p.toLowerCase())||"free",h=e.show_powered_by,f=e.subscription_start,y=e.subscription_end;return g.useEffect(()=>{new URLSearchParams(s.search).get("session_id")&&(fn({title:n("subscription_activated_title"),description:n("subscription_activated_desc")}),t&&t().then(()=>{var m;console.log("✅ Plan actualizado tras sesión Stripe:",(m=e.plan)==null?void 0:m.id)}))},[s]),d.jsxs("div",{style:{marginTop:"2rem"},children:[d.jsxs("div",{style:{backgroundColor:"white",border:"1px solid #4a90e2",borderRadius:"16px",padding:"1.5rem",boxShadow:"0 4px 10px rgba(0,0,0,0.08)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[d.jsxs("h3",{style:{color:"#274472",fontSize:"1.2rem",fontWeight:"bold"},children:["🧾 ",n("your_current_plan")]}),d.jsx("span",{style:{backgroundColor:"#4a90e2",color:"white",padding:"4px 12px",borderRadius:"999px",fontSize:"0.85rem",textTransform:"capitalize"},children:(c==null?void 0:c.name)||u})]}),d.jsxs("ul",{style:{fontSize:"0.95rem",paddingLeft:"1rem",marginBottom:"1rem",lineHeight:"1.8",color:"#1b2a41"},children:[d.jsxs("li",{children:[d.jsxs("strong",{style:{color:"#4a90e2"},children:["💬 ",n("messages"),":"]})," ",c!=null&&c.is_unlimited?n("unlimited"):(c==null?void 0:c.max_messages)??"—"]}),d.jsxs("li",{children:[d.jsxs("strong",{style:{color:"#4a90e2"},children:["📄 ",n("documents"),":"]})," ",c!=null&&c.is_unlimited?n("unlimited"):(c==null?void 0:c.max_documents)??"—"]}),d.jsxs("li",{children:[d.jsxs("strong",{style:{color:"#4a90e2"},children:["🔖 ",n("branding_active"),":"]})," ",n(h?"yes":"no")]}),f&&d.jsxs("li",{children:[d.jsxs("strong",{style:{color:"#4a90e2"},children:["📅 ",n("start_date"),":"]})," ",l(f)]}),y&&d.jsxs("li",{children:[d.jsxs("strong",{style:{color:"#4a90e2"},children:["⏳ ",n("end_date"),":"]})," ",l(y)]})]}),d.jsxs("div",{style:{backgroundColor:"#fef3c7",border:"1px solid #f5a623",padding:"1rem",borderRadius:"8px",fontSize:"0.95rem",color:"#1b2a41"},children:[n("change_plan_help")," ",d.jsx("a",{href:"mailto:support@evolvianai.com",style:{color:"#4a90e2",textDecoration:"underline"},children:"support@evolvianai.com"})]})]}),d.jsxs("h4",{style:{fontSize:"1.1rem",marginTop:"2rem",marginBottom:"1rem",color:"#f5a623"},children:["💡 ",n("see_plans")]}),d.jsx("div",{style:{display:"flex",flexDirection:"row",gap:"1rem",overflowX:"auto",paddingBottom:"0.5rem"},children:a.map(b=>{const m=u===b.id;return d.jsxs("div",{style:{minWidth:"240px",flex:"0 0 auto",border:m?"2px solid #a3d9b1":"1px solid #ccc",borderRadius:"12px",padding:"1rem",backgroundColor:"#fff",color:"#1b2a41"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("h5",{style:{margin:0,fontSize:"1rem",color:"#1b2a41"},children:b.name}),b.price&&d.jsx("span",{style:{fontWeight:"bold"},children:b.price})]}),d.jsx("ul",{style:{marginTop:"0.5rem",fontSize:"0.9rem",paddingLeft:"1rem"},children:b.features.map((v,x)=>d.jsx("li",{children:v},x))}),b.id==="white_label"&&d.jsxs("p",{style:{marginTop:"0.75rem",fontSize:"0.85rem",color:"#4a90e2",fontWeight:"bold"},children:[n("contact_for_whitelabel")," ",d.jsx("a",{href:"mailto:support@evolvianai.com",style:{textDecoration:"underline"},children:"support@evolvianai.com"})]}),m&&d.jsxs("div",{style:{marginTop:"0.75rem",fontSize:"0.85rem",color:"#4a90e2",fontWeight:"bold"},children:["✅ ",n("current_plan")]})]},b.id)})})]})}const Qs={chat_widget:["free","starter","premium"],email_support:["starter","premium"],whatsapp_integration:["premium"],custom_greeting:["starter","premium"],white_labeling:["white_label"]},Zs=["free","starter","premium","white_label"];function ip({activeTab:r,plan:e}){const{t}=W();if(console.log("📢 Render FeatureList"),console.log("🧾 activeTab:",r),console.log("📦 plan prop:",e),r!=="features")return null;const n=typeof(e==null?void 0:e.id)=="string"?e.id.toLowerCase():"free",s=(o,a)=>{const l=Qs[o];if(!l)return!1;const c=Zs.indexOf(a);return l.some(u=>Zs.indexOf(u)<=c)},i=o=>{const a=Qs[o];return!a||a.length===0?"—":a.includes("free")?t("free"):a.includes("starter")?t("starter"):a.includes("premium")?t("premium"):a[0]};return d.jsxs("div",{style:{marginTop:"2rem",backgroundColor:"white",border:"1px solid #4a90e2",borderRadius:"16px",padding:"1.5rem",boxShadow:"0 4px 10px rgba(0,0,0,0.08)"},children:[d.jsxs("h4",{style:{fontSize:"1.1rem",fontWeight:"bold",color:"#274472",marginBottom:"1rem"},children:["🧩 ",t("included_features")]}),d.jsx("ul",{style:{listStyle:"none",padding:0,margin:0,fontSize:"0.95rem"},children:[{key:"chat_widget",label:t("chat_widget"),icon:"💬"},{key:"email_support",label:t("email_support"),icon:"✉️"},{key:"whatsapp_integration",label:t("whatsapp_integration"),icon:"📱"},{key:"custom_greeting",label:t("custom_greeting"),icon:"👋"},{key:"white_labeling",label:t("white_labeling"),icon:"🏷️"}].map(o=>{const a=s(o.key,n);return d.jsxs("li",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"0.5rem",color:a?"#4a90e2":"#999"},children:[d.jsx("span",{children:o.icon}),d.jsx("span",{children:o.label}),d.jsx("span",{style:{marginLeft:"auto",backgroundColor:a?"#a3d9b1":"#f5a623",color:"#1b2a41",fontSize:"0.7rem",padding:"2px 6px",borderRadius:"999px",fontWeight:"bold"},children:a?t("included_in_plan"):`${t("available_from")} ${i(o.key)}`})]},o.key)})})]})}function op({activeTab:r,custom_prompt:e,hasPromptFeature:t,onChange:n,maxLength:s,defaultPrompt:i,temperature:o}){const{t:a}=W();if(r!=="prompt")return null;const l=e||i,c=l.length>s;return d.jsxs("div",{style:{marginTop:"2rem",display:"flex",flexDirection:"column",gap:"1.5rem"},children:[d.jsxs("div",{children:[d.jsx("label",{children:a("custom_prompt")}),d.jsx("textarea",{name:"custom_prompt",value:l,onChange:n,readOnly:!t,rows:6,style:{width:"100%",padding:"8px",borderRadius:"6px",border:c?"2px solid #e53935":"1px solid #ccc",marginTop:"4px",fontFamily:"inherit"}}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"4px"},children:[!t&&d.jsx("p",{style:{color:"#888",fontSize:"0.85rem"},children:a("custom_prompt_locked")}),d.jsxs("p",{style:{fontSize:"0.85rem",color:c?"#e53935":"#666"},children:[l.length," / ",s," ",a("characters")]})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("label",{htmlFor:"temperature",style:{fontWeight:"bold"},children:["🌡️ ",a("temperature_label")||"Model temperature (0.0 - 1.0)"]}),d.jsx("input",{type:"number",step:"0.1",min:"0",max:"1",name:"temperature",id:"temperature",value:o,onChange:n,readOnly:!t,style:{padding:"0.5rem",border:"1px solid #ccc",borderRadius:"4px",width:"100%",backgroundColor:t?"white":"#f5f5f5",color:t?"#000":"#999"}}),!t&&d.jsx("small",{style:{color:"#888"},children:a("upgrade_to_edit_temperature")||"Upgrade your plan to customize temperature."})]})]})}function ap(){var m,v;const r=Ee(),{t:e}=W(),[t,n]=g.useState("plan"),[s,i]=g.useState({assistant_name:"",language:"es",temperature:.7,plan:null,show_powered_by:!0,custom_prompt:"",require_email:!1,require_phone:!1,require_terms:!1}),[o,a]=g.useState({message:"",type:""}),[l,c]=g.useState(!0),u=e("default_prompt")||"Eres un asistente de IA diseñado para ayudar con preguntas sobre los documentos cargados por el cliente.",h=2e3,f=g.useCallback(async()=>{if(r){try{console.log("📡 Fetching settings for:",r);const x=await fetch(`http://localhost:8001/client_settings?client_id=${r}`),w=await x.json();if(console.log("📦 Response from /client_settings:",w),x.ok&&w){const S=w.plan||{id:"free",plan_features:[]};i(E=>({...E,...w,plan:{...S,plan_features:S.plan_features??[]}})),console.log("🧾 Plan actualizado en estado:",S==null?void 0:S.id)}else console.error("❌ Error al obtener configuración:",w)}catch(x){console.error("❌ Error de red en fetchSettings:",x)}c(!1)}},[r]);g.useEffect(()=>{f()},[f]);const y=x=>{const{name:w,type:S,checked:E,value:P}=x.target;i(O=>({...O,[w]:S==="checkbox"?E:P}))},p=async x=>{if(x.preventDefault(),(s.custom_prompt||u).length>h){a({message:`❌ ${e("prompt_too_long")}`,type:"error"});return}const w={client_id:r,assistant_name:s.assistant_name,language:s.language,temperature:s.temperature,custom_prompt:s.custom_prompt,require_email:s.require_email,require_phone:s.require_phone,require_terms:s.require_terms};try{console.log("📤 Enviando payload:",w);const S=await fetch("http://localhost:8001/client_settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)}),E=await S.json();console.log("📨 Respuesta POST /client_settings:",E),S.ok?a({message:`✅ ${e("settings_saved")}`,type:"success"}):a({message:`❌ ${E.error||e("error_saving")}`,type:"error"})}catch(S){console.error("❌ Error en handleSubmit:",S),a({message:"❌ Error al guardar configuración.",type:"error"})}},b=((v=(m=s.plan)==null?void 0:m.plan_features)==null?void 0:v.some(x=>{var w,S;return typeof x=="string"?x==="custom_prompt_editing":((S=(w=x==null?void 0:x.feature)==null?void 0:w.toLowerCase())==null?void 0:S.replace(/\s+/g,"_"))==="custom_prompt_editing"}))??!1;return l?d.jsx("p",{children:e("loading_settings")}):(console.log("📌 Renderizando ClientSettings con tab:",t),d.jsxs("div",{style:{padding:"2rem",maxWidth:"700px",margin:"0 auto"},children:[d.jsxs("h2",{children:["⚙️ ",e("client_settings")]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem",flexWrap:"wrap"},children:[d.jsxs("button",{onClick:()=>n("plan"),style:Vr(t==="plan"),children:["🧾 ",e("your_current_plan")]}),d.jsxs("button",{onClick:()=>n("features"),style:Vr(t==="features"),children:["🧩 ",e("included_features")]}),d.jsxs("button",{onClick:()=>n("prompt"),style:Vr(t==="prompt"),children:["🎨 ",e("custom_prompt")]})]}),t==="plan"&&d.jsx(sp,{activeTab:t,formData:s,refetchSettings:f}),t==="features"&&d.jsx(ip,{activeTab:t,plan:s.plan}),t==="prompt"&&d.jsxs("form",{onSubmit:p,style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[d.jsx(op,{activeTab:t,custom_prompt:s.custom_prompt,temperature:s.temperature,hasPromptFeature:b,onChange:y,maxLength:h,defaultPrompt:u}),d.jsx("button",{type:"submit",style:{backgroundColor:"#4a90e2",color:"white",padding:"10px 16px",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold",width:"fit-content"},children:e("save_settings")})]}),o.message&&d.jsx("p",{style:{marginTop:"1.5rem",fontWeight:"bold",color:o.type==="error"?"#e53935":"#2e7d32"},children:o.message})]}))}const Vr=r=>({padding:"6px 12px",backgroundColor:r?"#a3d9b1":"#ededed",color:"#274472",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:"500",fontSize:"0.9rem"});function lp(){const{lang:r,changeLanguage:e}=W();return d.jsxs("div",{style:cp,children:[d.jsx("button",{onClick:()=>e("en"),disabled:r==="en",style:{...ei,backgroundColor:r==="en"?"#4a90e2":"#ededed",color:r==="en"?"white":"#274472"},children:"English"}),d.jsx("button",{onClick:()=>e("es"),disabled:r==="es",style:{...ei,backgroundColor:r==="es"?"#4a90e2":"#ededed",color:r==="es"?"white":"#274472"},children:"Español"})]})}const cp={display:"flex",justifyContent:"center",gap:"0.5rem",marginTop:"1rem"},ei={padding:"0.4rem 0.8rem",borderRadius:"8px",border:"none",fontWeight:"bold",cursor:"pointer"};function dp(){const r=be(),e=Ee(),{t}=W(),[n,s]=g.useState([]),[i,o]=g.useState(null);g.useEffect(()=>{(async()=>{var u,h;if(e)try{const f=await fetch(`http://localhost:8001/client_settings?client_id=${e}`),y=await f.json();if(f.ok){const p=m=>m.toLowerCase().replace(/\s+/g,"_"),b=((h=(u=y.plan)==null?void 0:u.plan_features)==null?void 0:h.map(m=>p(m.feature)))||[];s(b)}}catch(f){console.error("❌ Error al conectar con el backend:",f)}})()},[e]);const a=async()=>{await Z.auth.signOut(),localStorage.clear(),r("/login",{replace:!0}),window.location.reload()},l=c=>n.includes(c);return d.jsx("aside",{style:up,children:d.jsxs("div",{children:[d.jsxs("div",{style:hp,children:[d.jsx("img",{src:"/logo-evolvian.svg",alt:"Evolvian Logo",style:{width:"60px",margin:"0 auto"}}),d.jsx(lp,{})]}),d.jsxs("nav",{style:fp,children:[d.jsx(lr,{label:`📊 ${t("dashboard")}`,to:"/dashboard",hovered:i,setHovered:o,id:"dashboard"}),d.jsx(lr,{label:`📤 ${t("upload")}`,to:"/upload",hovered:i,setHovered:o,id:"upload"}),d.jsx(lr,{label:`📚 ${t("history")}`,to:"/history",hovered:i,setHovered:o,id:"history"}),[{label:`🧠 ${t("chat_assistant")}`,path:"/services/chat",feature:"chat_widget"},{label:`💬 ${t("whatsapp")}`,path:"/services/whatsapp",feature:"whatsapp_integration"},{label:"📅 Google Calendar",path:"/services/calendar",feature:"calendar_sync"}].map(({label:c,path:u,feature:h})=>{const f=l(h),y=u;return d.jsxs("div",{style:pn,children:[d.jsx(Ne,{to:f?u:"#",style:{...uo,backgroundColor:i===y?"#4a90e2":"transparent",color:f?"white":"#999",pointerEvents:f?"auto":"none"},onMouseEnter:()=>o(y),onMouseLeave:()=>o(null),title:f?"":t("premium_only"),children:c}),!f&&d.jsx("span",{style:{...pp,marginLeft:"8px"},children:"Premium"})]},h)}),d.jsx(lr,{label:`⚙️ ${t("settings")}`,to:"/settings",hovered:i,setHovered:o,id:"settings"}),d.jsx("div",{style:{...pn,marginTop:"1.5rem"},children:d.jsx("button",{onClick:a,style:mp,children:t("logout")})})]})]})})}function lr({to:r,label:e,hovered:t,setHovered:n,id:s}){return d.jsx("div",{style:pn,children:d.jsx(Ne,{to:r,onMouseEnter:()=>n(s),onMouseLeave:()=>n(null),style:{...uo,backgroundColor:t===s?"#4a90e2":"transparent"},children:e})})}const up={width:"240px",background:"#274472",color:"white",padding:"2rem 1.5rem",minHeight:"100vh",display:"flex",flexDirection:"column"},hp={textAlign:"center",marginBottom:"2rem"},fp={display:"flex",flexDirection:"column"},pn={padding:"0.4rem 0.6rem",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},uo={color:"white",textDecoration:"none",fontWeight:"500",fontSize:"1rem",transition:"all 0.2s ease",display:"block",borderRadius:"6px"},pp={backgroundColor:"#f5a623",color:"#1b2a41",fontSize:"0.7rem",padding:"2px 6px",borderRadius:"999px",fontWeight:"bold",verticalAlign:"middle"},mp={backgroundColor:"#f5a623",color:"white",border:"none",borderRadius:"8px",padding:"0.5rem 1rem",cursor:"pointer",fontWeight:"bold",width:"100%"},gp="evolvian-internal";function yp(){const[r,e]=g.useState(!1),t=gp;return d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>e(!r),style:{position:"fixed",bottom:r?"540px":"24px",right:"24px",zIndex:1e4,backgroundColor:"#4a90e2",color:"white",borderRadius:"50%",width:"48px",height:"48px",border:"none",fontSize:"20px",cursor:"pointer"},children:r?"×":"💬"}),r&&d.jsx("div",{style:bp.container,children:d.jsx(wr,{clientId:t})})]})}const bp={container:{position:"fixed",bottom:"24px",right:"24px",width:"360px",height:"500px",backgroundColor:"#ffffff",borderRadius:"16px",boxShadow:"0 6px 24px rgba(0,0,0,0.2)",zIndex:9999,overflow:"hidden"}};function Re({children:r}){return d.jsxs("div",{style:vp,children:[d.jsx("header",{style:wp,children:"Evolvian™"}),d.jsxs("div",{style:_p,children:[d.jsx(dp,{}),d.jsx("main",{style:xp,children:r})]}),d.jsxs("footer",{style:Sp,children:[d.jsx("div",{children:"Evolvian™ is a pending trademark application filed with the USPTO. All rights reserved."}),d.jsxs("div",{children:["Version v1.0 —"," ",d.jsx("a",{href:"https://evolvian.com",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"underline",color:"#a3d9b1"},children:"Visit Public Site"})," ","|"," ",d.jsx("a",{href:"/terms",style:{textDecoration:"underline",color:"#a3d9b1"},children:"Terms & Conditions"})]})]}),d.jsx(yp,{})]})}const vp={display:"flex",flexDirection:"column",minHeight:"100vh",backgroundColor:"#0f1c2e",color:"white"},wp={padding:"1rem",fontSize:"1.5rem",fontWeight:"bold",color:"#f5a623",backgroundColor:"#1b2a41",textAlign:"center"},_p={display:"flex",flex:1},xp={flex:1,padding:"2rem",overflowY:"auto"},Sp={textAlign:"center",padding:"1rem",fontSize:"0.875rem",backgroundColor:"#1b2a41",color:"#ededed"};function jp({children:r}){const[e,t]=g.useState(!0),[n,s]=g.useState(!1),[i,o]=g.useState(!1);return g.useEffect(()=>{(async()=>{const{data:{session:l}}=await Z.auth.getSession();l||o(!0),s(!!l),t(!1)})()},[]),e?d.jsx("p",{className:"p-6",children:"🔐 Verificando sesión..."}):i?(alert("⚠️ Debes iniciar sesión para acceder a esta sección."),d.jsx(ui,{to:"/login",replace:!0})):r}function Te({children:r}){const{session:e,clientId:t,loading:n}=co();return n?d.jsx("div",{style:{padding:"2rem",color:"white"},children:"🔄 Cargando sesión..."}):!e||!t?d.jsx("div",{style:{padding:"2rem",color:"white"},children:"⛔ Sesión no válida. Por favor inicia sesión."}):d.jsx(jp,{children:r})}function Ep(){const[r]=yi(),e=r.get("public_client_id"),[t,n]=g.useState(null),[s,i]=g.useState(!0);return g.useEffect(()=>{if(!e){console.warn("⚠️ No se encontró public_client_id en la URL");return}(async()=>{try{const l=await(await fetch(`http://localhost:8001/client_settings?public_client_id=${e}`)).json();console.log(`⚙️ Settings cargados desde backend (crudo):
`,JSON.stringify(l,null,2));const c=(l==null?void 0:l.settings)||l;console.log("📌 Usando configuración extraída:",c),n(c)}catch(a){console.error("❌ Error al obtener settings:",a)}finally{i(!1)}})()},[e]),e?s?d.jsx("p",{children:"🔄 Cargando configuración del cliente..."}):t?d.jsx("div",{style:{height:"100vh",padding:"1rem",fontFamily:"sans-serif"},children:d.jsx(wr,{clientId:e,requireEmail:t.require_email,requirePhone:t.require_phone,requireTerms:t.require_terms})}):d.jsx("p",{children:"⚠️ No se pudo cargar la configuración del asistente."}):d.jsxs("p",{children:["❌ No hay public_client_id en la URL. Usa ",d.jsx("code",{children:"?public_client_id=..."})]})}function kp(){return d.jsx("div",{style:U.container,children:d.jsxs("div",{style:U.card,children:[d.jsx("h1",{style:U.title,children:"Terms and Conditions"}),d.jsx("p",{style:U.paragraph,children:"These Terms and Conditions (“Terms”) govern your use of the Evolvian™ platform (“Service”). By accessing or using our Service, you agree to be bound by these Terms. If you do not agree, please do not use the Service."}),d.jsx("h2",{style:U.subtitle,children:"1. Use of Service"}),d.jsx("p",{style:U.paragraph,children:"You must be at least 18 years old to use the Service. You agree to use the platform only for lawful purposes and in accordance with these Terms."}),d.jsx("h2",{style:U.subtitle,children:"2. Account Responsibility"}),d.jsx("p",{style:U.paragraph,children:"You are responsible for maintaining the confidentiality of your credentials and for any activity conducted under your account. You agree to notify us immediately of any unauthorized use."}),d.jsx("h2",{style:U.subtitle,children:"3. Document Privacy"}),d.jsx("p",{style:U.paragraph,children:"Documents uploaded to Evolvian are private and are not shared with third parties or used to train any public AI model. We do not access your data unless explicitly authorized or required by law."}),d.jsx("h2",{style:U.subtitle,children:"4. Intellectual Property"}),d.jsx("p",{style:U.paragraph,children:"All intellectual property rights in the platform and its components are owned by Evolvian. You retain ownership of any documents or data you upload."}),d.jsx("h2",{style:U.subtitle,children:"5. Prohibited Activities"}),d.jsx("p",{style:U.paragraph,children:"You agree not to misuse the platform, including but not limited to uploading malicious content, violating privacy rights, reverse engineering the software, or exceeding usage limits based on your plan."}),d.jsx("h2",{style:U.subtitle,children:"6. Service Availability"}),d.jsx("p",{style:U.paragraph,children:"We aim to provide continuous access but do not guarantee uninterrupted availability. We may suspend access for maintenance or upgrades with prior notice when possible."}),d.jsx("h2",{style:U.subtitle,children:"7. Limitation of Liability"}),d.jsx("p",{style:U.paragraph,children:"Evolvian is not liable for any indirect, incidental, or consequential damages resulting from the use or inability to use the Service, to the extent permitted by law."}),d.jsx("h2",{style:U.subtitle,children:"8. Changes to Terms"}),d.jsx("p",{style:U.paragraph,children:"We may update these Terms at any time. Continued use of the Service after such changes implies acceptance. We encourage users to review the Terms periodically."}),d.jsx("h2",{style:U.subtitle,children:"9. Contact"}),d.jsxs("p",{style:U.paragraph,children:["For any questions regarding these Terms, please contact us at ",d.jsx("a",{href:"mailto:legal@evolvian.com",style:U.link,children:"legal@evolvian.com"}),"."]})]})})}const U={container:{minHeight:"100vh",backgroundColor:"#0f1c2e",display:"flex",justifyContent:"center",alignItems:"center",padding:"2rem"},card:{backgroundColor:"#1b2a41",borderRadius:"1rem",padding:"2.5rem",maxWidth:"750px",width:"100%",border:"1px solid #274472",color:"#ededed"},title:{color:"#a3d9b1",fontSize:"2rem",marginBottom:"1.5rem"},subtitle:{color:"#f5a623",fontSize:"1.2rem",marginTop:"1.5rem",marginBottom:"0.5rem"},paragraph:{fontSize:"1rem",lineHeight:"1.6",marginBottom:"1rem"},link:{color:"#4a90e2",textDecoration:"underline"}};function Cp(){const r=ae();return["/","/login","/register","/confirm","/forgot-password","/reset-password","/verify-mfa","/welcome","/chat-widget","/widget","/widget-preview","/terms"].includes(r.pathname),d.jsxs(ba,{children:[d.jsx(F,{path:"/",element:d.jsx(ui,{to:"/login"})}),d.jsx(F,{path:"/login",element:d.jsx(pd,{})}),d.jsx(F,{path:"/register",element:d.jsx(Xd,{})}),d.jsx(F,{path:"/confirm",element:d.jsx(iu,{})}),d.jsx(F,{path:"/forgot-password",element:d.jsx(du,{})}),d.jsx(F,{path:"/reset-password",element:d.jsx(wu,{})}),d.jsx(F,{path:"/verify-mfa",element:d.jsx(Tu,{})}),d.jsx(F,{path:"/welcome",element:d.jsx(Bu,{})}),d.jsx(F,{path:"/terms",element:d.jsx(kp,{})}),d.jsx(F,{path:"/chat-widget",element:d.jsx(Uu,{})}),d.jsx(F,{path:"/widget",element:d.jsx(Fu,{})}),d.jsx(F,{path:"/widget-preview",element:d.jsx(Ep,{})}),d.jsx(F,{path:"/dashboard",element:d.jsx(Te,{children:d.jsx(Re,{children:d.jsx(th,{})})})}),d.jsx(F,{path:"/upload",element:d.jsx(Te,{children:d.jsx(Re,{children:d.jsx(rh,{})})})}),d.jsx(F,{path:"/history",element:d.jsx(Te,{children:d.jsx(Re,{children:d.jsx($f,{})})})}),d.jsx(F,{path:"/services",element:d.jsx(Te,{children:d.jsx(Re,{children:d.jsx(Ff,{})})})}),d.jsx(F,{path:"/services/chat",element:d.jsx(Te,{children:d.jsx(Re,{children:d.jsx(Mf,{})})})}),d.jsx(F,{path:"/services/email",element:d.jsx(Te,{children:d.jsx(Re,{children:d.jsx(Kf,{})})})}),d.jsx(F,{path:"/services/whatsapp",element:d.jsx(Te,{children:d.jsx(Re,{children:d.jsx(If,{})})})}),d.jsx(F,{path:"/services/calendar",element:d.jsx(Te,{children:d.jsx(Re,{children:d.jsx(np,{})})})}),d.jsx(F,{path:"/settings",element:d.jsx(Te,{children:d.jsx(Re,{children:d.jsx(ap,{})})})}),d.jsx(F,{path:"*",element:d.jsx(Nu,{})})]})}Co.createRoot(document.getElementById("root")).render(d.jsx(j.StrictMode,{children:d.jsxs(Ro,{children:[" ",d.jsx(qa,{children:d.jsxs(d.Fragment,{children:[d.jsx(Cp,{}),d.jsx(Yd,{position:"top-right",richColors:!0})," "]})})]})}));
